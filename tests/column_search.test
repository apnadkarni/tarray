# column search tests

source testutil.tcl

namespace eval tarray::test {

    namespace import ::tcl::mathop::*

    foreach type {any string boolean byte double int uint wide} {

        test column_search-$type-eq-1.0 {
            Search an empty column
        } -body {
            tarray::column search -eq [newcolumn $type] [samplevalue $type]
        } -result -1

        test column_search-$type-eq-1.1 {
            Search an empty column -all
        } -body {
            tarray::column search -eq -all [newcolumn $type] [samplevalue $type]
        } -result [crep int {}] -match column

        test column_search-$type-eq-1.2 {
            Search an empty column -inline
        } -body {
            tarray::column search -eq -inline [newcolumn $type] [samplevalue $type]
        } -result {}

        test column_search-$type-eq-1.3 {
            Search an empty column -inline -all
        } -body {
            tarray::column search -eq -inline -all [newcolumn $type] [samplevalue $type]
        } -result [crep $type {}] -match column

        test column_search-$type-eq-1.4 {
            Search an empty column -not
        } -body {
            tarray::column search -eq -not [newcolumn $type] [samplevalue $type]
        } -result -1

        test column_search-$type-eq-1.5 {
            Search an empty column -not -inline
        } -body {
            tarray::column search -eq -not -inline [newcolumn $type] [samplevalue $type]
        } -result {}

        test column_search-$type-eq-1.6 {
            Search an empty column -not -inline -all
        } -body {
            tarray::column search -eq -not -all -inline [newcolumn $type] [samplevalue $type]
        } -result [crep $type {}] -match column


        test column_search-$type-eq-2.0 {
            Match on first element
        } -body {
            tarray::column search -eq [samplecolumn $type] [samplevalue $type 0]
        } -result 0

        test column_search-$type-eq-2.1 {
            Match on last element
        } -body {
            # Note last element may occur multiple times
            tarray::column search -eq [samplecolumn $type] [samplevalue $type end]
        } -result [lsearch -exact [samplerange $type] [samplevalue $type end]]

        test column_search-$type-eq-2.2 {
            Match -eq -inline
        } -body {
            # Note last element may occur multiple times
            tarray::column search -inline -eq [samplecolumn $type] [samplevalue $type end]
        } -result [lsearch -exact -inline [samplerange $type] [samplevalue $type end]]

        test column_search-$type-eq-2.3 {
            Match -eq -all
        } -body {
            tarray::column search -all -eq [samplecolumn $type] [samplevalue $type 0]
        } -result [crep int [lsearch -exact -all [samplerange $type] [samplevalue $type 0]]] -match column

        test column_search-$type-eq-2.4 {
            Match -eq -all (ensure duplicates)
        } -body {
            set val [samplevalue $type 0]
            set l [linsert [linsert [samplerange $type] 0 $val] end-5 $val]
            lappend l $val
            clequal [tarray::column search -all -eq [newcolumn $type $l] $val] int [lsearch -exact -all $l $val]
        } -result 1

        test column_search-$type-eq-2.5 {
            Match -eq -all -inline (ensure duplicates)
        } -body {
            set val [samplevalue $type 0]
            set l [linsert [linsert [samplerange $type] 0 $val] end-5 $val]
            lappend l $val
            clequal [tarray::column search -all -inline -eq [newcolumn $type $l] $val] $type [lsearch -exact -all -inline $l $val]
        } -result 1

        test column_search-$type-eq-2.6 {
            Match -eq -not
        } -body {
            tarray::column search -eq -not [newcolumn $type {0 0 0 0 1 0 0}] 0
        } -result 4

        test column_search-$type-eq-2.7 {
            Match -eq -not -inline
        } -body {
            tarray::column search -eq -not -inline [samplecolumn $type] [samplevalue $type 0]
        } -result [samplevalue $type 1]

        test column_search-$type-eq-2.8 {
            Match -eq -not -all (ensure duplicates)
        } -body {
            set val [samplevalue $type 0]
            set l [linsert [linsert [samplerange $type] 0 $val] end-5 $val]
            lappend l $val
            clequal [tarray::column search -all -not -eq [newcolumn $type $l] $val] int [lsearch -exact -all -not $l $val]
        } -result 1
            
        test column_search-$type-eq-2.9 {
            Match -eq -not -all -inline (ensure duplicates)
        } -body {
            set val [samplevalue $type 0]
            set l [linsert [linsert [samplerange $type] 0 $val] end-5 $val]
            lappend l $val
            clequal [tarray::column search -inline -all -not -eq [newcolumn $type $l] $val] $type [lsearch -exact -all -not -inline $l $val]
        } -result 1
            
        test column_search-$type-eq-2.10 {
            Match -eq -all -range
        } -body {
            tarray::column search -range 1 -all -eq [samplecolumn $type] [samplevalue $type 0]
        } -result [crep int [lsearch -start 1 -exact -all [samplerange $type] [samplevalue $type 0]]] -match column

        test column_search-$type-eq-2.11 {
            Match -eq -all -range (ensure duplicates)
        } -body {
            set l [samplerange $type 0 20 0 10]
            set val [lindex $l 9]
            clequal [tarray::column search -all -eq -range 10 [newcolumn $type $l] $val] int [lsearch -exact -all -start 10 $l $val]
        } -result 1

        test column_search-$type-eq-2.12 {
            Match -eq -all -inline -range (ensure duplicates)
        } -body {
            set l [samplerange $type 0 20 0 10 3 3]
            set val [lindex $l 3]
            clequal [tarray::column search -all -inline -range 4 -eq [newcolumn $type $l] $val] $type [lsearch -exact -all -inline -start 4 $l $val]
        } -result 1

        test column_search-$type-eq-2.13 {
            Match -eq -not -range
        } -body {
            tarray::column search -eq -not -range 4 [newcolumn $type {0 0 0 1 0 0 1 0}] 0
        } -result 6

        test column_search-$type-eq-2.14 {
            Match -eq -not -range -inline
        } -body {
            tarray::column search -eq -not -inline -range 4 [newcolumn $type {0 0 0 1 0 0  0}] 0
        } -result ""

        test column_search-$type-eq-2.15 {
            Match -eq -not -inline -range -all
        } -body {
            set val [samplemax $type]
            set l [linsert [samplerange $type] 0 $val]
            lappend l $val
            set notval [samplemin $type]
            clequal [tarray::column search -eq  -all -not -inline -range 1 [newcolumn $type $l] $notval] $type [lsearch -exact -all -not -inline -start 1 $l $notval]
        } -result 1
            
        test column_search-$type-eq-2.16 {
            Match -range -1
        } -body {
            tarray::column search -eq -range -1 [samplecolumn $type] [samplevalue $type 0]
        } -result [lsearch -start -1 [samplerange $type] [samplevalue $type 0]]

        test column_search-$type-eq-2.17 {
            Match -range out of bounds
        } -body {
            tarray::column search -eq -range 10000000 [samplecolumn $type] [samplevalue $type 0]
        } -result -1

        test column_search-$type-eq-2.18 {
            Match -range out of bounds
        } -body {
            tarray::column search -eq -inline -all -range 10000000 [samplecolumn $type] [samplevalue $type 0]
        } -result [crep $type {}] -match column

        test column_search-$type-eq-2.19 {
            Match -range end
        } -body {
            tarray::column search -eq -range end [newcolumn $type {0 0 0 0 1}] 1
        } -result 4

        test column_search-$type-eq-2.20 {
            Match -eq -all -range
        } -body {
            tarray::column search -range {1 end} -all -eq [samplecolumn $type] [samplevalue $type 0]
        } -result [crep int [lsearch -start 1 -exact -all [samplerange $type] [samplevalue $type 0]]] -match column

        test column_search-$type-eq-2.21 {
            Match -eq -all -range (ensure duplicates)
        } -body {
            set l [samplerange $type 0 9 0 9 0 9 0 9]
            set val [lindex $l 5]
            clequal [tarray::column search -all -eq -range {6 30} [newcolumn $type $l] $val] int [lsearch -exact -all -start 6 [lrange $l 0 30] $val]
        } -result 1

        test column_search-$type-eq-2.22 {
            Match -eq -all -range -inline (ensure duplicates)
        } -body {
            set l [samplerange $type 0 9 0 9 0 9 0 9]
            set val [lindex $l 5]
            clequal [tarray::column search -all -eq -inline -range {6 30} [newcolumn $type $l] $val] $type [lsearch -exact -all -inline -start 6 [lrange $l 0 30] $val]
        } -result 1

        test column_search-$type-eq-2.23 {
            Match -eq -not -range
        } -body {
            tarray::column search -eq -not -range {4 6} [newcolumn $type {0 0 0 1 0 0 1 0}] 0
        } -result 6

        test column_search-$type-eq-2.24 {
            Match -eq -not -range -inline
        } -body {
            tarray::column search -eq -not -inline -range {4 6} [newcolumn $type {0 0 0 1 0 0 0 1}] 0
        } -result ""

        test column_search-$type-eq-2.25 {
            Match -eq -not -range -inline
        } -body {
            tarray::column search -eq -not -inline -range {4 4} [newcolumn $type {0 0 0 0 1 0 0 0 1}] 0
        } -result 1 -match numeric

        test column_search-$type-eq-2.26 {
            Match -range -1,10
        } -body {
            tarray::column search -eq -range {-1 10} [samplecolumn $type] [samplevalue $type 3]
        } -result [lsearch -start -1 [samplerange $type] [samplevalue $type 3]]

        test column_search-$type-eq-2.27 {
            Match -range out of bounds
        } -body {
            tarray::column search -eq -range {1000000 10000000} [samplecolumn $type] [samplevalue $type 0]
        } -result -1

        test column_search-$type-eq-2.28 {
            Match -range out of bounds
        } -body {
            tarray::column search -eq -inline -all -range {100000 10000000} [samplecolumn $type] [samplevalue $type 0]
        } -result [crep $type {}] -match column

        test column_search-$type-eq-2.29 {
            Match -range end
        } -body {
            tarray::column search -eq -range {end end} [newcolumn $type {0 0 0 0 1}] 1
        } -result 4

        test column_search-$type-eq-2.30 {
            Match -range -inline (empty)
        } -body {
            tarray::column search -eq -range {0 end} [newcolumn $type {}] [samplevalue $type]
        } -result -1

        test column_search-$type-eq-2.31 {
            Match -range -inline (empty)
        } -body {
            tarray::column search -inline -eq -range {0 end} [newcolumn $type {}] [samplevalue $type]
        } -result {}

        test column_search-$type-eq-2.32 {
            Match -range -inline (reversed range)
        } -body {
            tarray::column search -inline -eq -range {end 0} [samplecolumn $type] [samplevalue $type]
        } -result {}

        test column_search-$type-eq-2.33 {
            Match -range (reversed range)
        } -body {
            tarray::column search -eq -range {10 0} [samplecolumn $type] [samplevalue $type]
        } -result -1

        if {$type ne "any" && $type ne "string"} {
            test column_search-$type-eq-3.0 {
                Match invalid value
            } -body {
                tarray::column search -eq [samplecolumn $type] [lindex [badvalues $type] 0]
            } -returnCodes error -result "*expected*but got*" -match glob
        }            

        test column_search-$type-eq-4.0 {
            Verify that -eq is default operation
        } -body {
            tarray::column search [samplecolumn $type] [samplevalue $type 0]
        } -result 0

        test column_search-$type-eq-5.0 {
            Match missing element
        } -body {
            set val [samplemax $type]
            tarray::column search -eq [newcolumn $type [samplefilter $type $val]] $val
        } -result -1

        test column_search-$type-eq-5.1 {
            Match missing element -inline
        } -body {
            set val [samplemax $type]
            tarray::column search -eq -inline [newcolumn $type [samplefilter $type $val]] $val
        } -result ""

        test column_search-$type-eq-5.2 {
            Match missing element -all
        } -body {
            set val [samplemax $type]
            tarray::column search -eq -all [newcolumn $type [samplefilter $type $val]] $val
        } -result [crep int {}]


        test column_search-$type-eq-5.3 {
            Match missing element -all
        } -body {
            set val [samplemax $type]
            tarray::column search -eq -all -inline [newcolumn $type [samplefilter $type $val]] $val
        } -result [crep $type {}]
        
        # NOTE: Tests 6.x for -eq are below. Do not use that test number here

    }

    # NOTE remaining tests are not valid for booleans.
    # Using the sample data for non-equality 
    # searches is not convenient so we have to list test data separately.

    foreach type {any string byte double int uint wide} {
        foreach op {-gt -lt} {
            test column_search-$type$op-1.0 {
                Search an empty column
            } -body {
                tarray::column search $op [newcolumn $type] [samplevalue $type]
            } -result -1

            test column_search-$type$op-1.1 {
                Search an empty column -all
            } -body {
                tarray::column search $op -all [newcolumn $type] [samplevalue $type]
            } -result [crep int {}] -match column

            test column_search-$type$op-1.2 {
                Search an empty column -inline
            } -body {
                tarray::column search $op -inline [newcolumn $type] [samplevalue $type]
            } -result {}

            test column_search-$type$op-1.3 {
                Search an empty column -inline -all
            } -body {
                tarray::column search $op -inline -all [newcolumn $type] [samplevalue $type]
            } -result [crep $type {}] -match column

            test column_search-$type$op-1.4 {
                Search an empty column -not
            } -body {
                tarray::column search $op -not [newcolumn $type] [samplevalue $type]
            } -result -1

            test column_search-$type$op-1.5 {
                Search an empty column -not -inline
            } -body {
                tarray::column search $op -not -inline [newcolumn $type] [samplevalue $type]
            } -result {}

            test column_search-$type$op-1.6 {
                Search an empty column -not -inline -all
            } -body {
                tarray::column search $op -not -all -inline [newcolumn $type] [samplevalue $type]
            } -result [crep $type {}] -match column
        }
    }
        
    #
    # Numeric types
    foreach type {byte double int uint wide} {

        #
        # Numeric -eq test for -among option only
        # Remaining -eq tests are above

        test column_search-$type-eq-6.1 {
            Match on element -among
        } -body {
            tarray::column search -eq -among {1 3 4} [newcolumn $type {5 128 10 100 100 101}] 100
        } -result 3

        test column_search-$type-eq-6.2 {
            Match on element -among (fail)
        } -body {
            tarray::column search -eq -among {1 3 4} [newcolumn $type {5 128 0 55 101}] 10
        } -result -1

        test column_search-$type-eq-6.3 {
            Match -inline -among
        } -body {
            tarray::column search -eq -inline -among {1 3 4 7} [newcolumn $type {
                100 180 75 100 100 230 250
            }] 100
        } -result 100 -match numeric

        test column_search-$type-eq-6.4 {
            Match -among out of order indices
        } -body {
            tarray::column search -eq -among {1 4 3 7} [newcolumn $type {
                100 180 75 100 100 230 250
            }] 100
        } -result 4

        test column_search-$type-eq-6.5 {
            Match -all -among (negative and out of bounds indices)
        } -body {
            tarray::column search -eq -all -among {-1 3 5 7} [newcolumn $type {
                100 100 100 200 100 100 100
            }] 100
        } -result [crep int {5}] -match column

        test column_search-$type-eq-6.6 {
            Match -not -all -among -inline (negative and out of bounds indices)
        } -body {
            tarray::column search -inline -not -eq -all -among {-1 3 5 6 7} [newcolumn $type {
                10 20 30 40 50 10 70
            }] 10
        } -result [crep $type {40 70}] -match column

        test column_search-$type-eq-6.7 {
            Match -among -range -all
        } -body {
            tarray::column search -eq -all -range {1 5} -among {0 5 7 5 4} [newcolumn $type {
                20 10 10 10 10 10 10
            }] 10
        } -result [crep int {5 5 4}] -match column

        test column_search-$type-eq-6.8 {
            Match -among -range -inline -all -not
        } -body {
            tarray::column search -not -eq -inline -all -range {1 5} -among {0 5 7 5 4} [newcolumn $type {
                20 30 40 50 10 70 80
            }] 10
        } -result [crep $type {70 70}] -match column

        test column_search-$type-eq-6.9 {
            Match -among -range
        } -body {
            tarray::column search -eq -range {1 5} -among {0 5 7 5 4} [newcolumn $type {
                20 10 10 10 10 10 10
            }] 10
        } -result 5

        test column_search-$type-eq-6.10 {
            Match -among -range -inline -not
        } -body {
            tarray::column search -inline -not -eq -range {1 5} -among {0 4 5 7 } [newcolumn $type {
                20 30 40 50 10 70 80
            }] 10
        } -result 70 -match numeric

        test column_search-$type-eq-6.11 {
            Match -range -inline (empty)
        } -body {
            tarray::column search -eq -among {0 1} [newcolumn $type {}] [samplevalue $type]
        } -result -1

        test column_search-$type-eq-6.12 {
            Match -range -inline (empty)
        } -body {
            tarray::column search -inline -eq -among {0} [newcolumn $type {}] [samplevalue $type]
        } -result {}

        test column_search-$type-eq-6.13 {
            Match -among -range reversed
        } -body {
            tarray::column search -eq -range {5 0} -among {0 1 2 3 4 5 6} [newcolumn $type {
                10 10 10 10 10 10 10 10 10
            }] 10
        } -result -1

        test column_search-$type-eq-6.14 {
            Match -among empty
        } -body {
            tarray::column search -eq -among {} [newcolumn $type {
                128 170 75 175 10 30 250 100
            }] 175
        } -result -1

        test column_search-$type-eq-6.15 {
            Match -among empty
        } -body {
            tarray::column search -inline -eq -among {} [newcolumn $type {
                128 170 75 175 10 30 250 100
            }] 175
        } -result {}

        test column_search-$type-eq-6.16 {
            Match -among empty
        } -body {
            tarray::column search -all -eq -among {} [newcolumn $type {
                128 170 75 175 10 30 250 100
            }] 175
        } -result [crep int {}] -match column

        #
        # Numeric -lt tests
        test column_search-$type-lt-2.0 {
            Match on first element
        } -body {
            tarray::column search -lt [newcolumn $type {5 10 128 255}] 100
        } -result 0

        test column_search-$type-lt-2.1 {
            Match on last element
        } -body {
            tarray::column search -lt [newcolumn $type {100 101 102 99}] 100
        } -result 3

        test column_search-$type-lt-2.2 {
            Match in middle, unsorted list
        } -body {
            tarray::column search -lt [newcolumn $type {
                128 180 75 75 10 230 250
            }] 100
        } -result 2

        test column_search-$type-lt-2.3 {
            Match -inline
        } -body {
            tarray::column search -lt -inline [newcolumn $type {
                128 180 75 75 10 230 250
            }] 75
        } -result 10 -match numeric

        test column_search-$type-lt-2.3 {
            Match -all (one element)
        } -body {
            tarray::column search -lt -all [newcolumn $type {
                128 180 70 75 128 230 128
            }] 75
        } -result [crep int {2}] -match column

        test column_search-$type-lt-2.4 {
            Match -all
        } -body {
            tarray::column search -lt -all [newcolumn $type {
                128 180 75 75 128 230 128
            }] 180
        } -result [crep int {0 2 3 4 6}] -match column

        test column_search-$type-lt-2.5 {
            Match -all -inline
        } -body {
            tarray::column search -lt -all -inline [newcolumn $type {
                28 180 75 75 128 230 128
            }] 128
        } -result [crep $type {28 75 75}] -match column

        test column_search-$type-lt-3.0 {
            Match on first element -not (when equal)
        } -body {
            tarray::column search -lt -not [newcolumn $type {
                100 5 10 128 255
            }] 100
        } -result 0

        test column_search-$type-lt-3.1 {
            Match on first element -not (when greater)
        } -body {
            tarray::column search -lt -not [newcolumn $type {
                110 5 10 128 255
            }] 100
        } -result 0

        test column_search-$type-lt-3.2 {
            Match on last element -not (when equal)
        } -body {
            tarray::column search -lt -not [newcolumn $type {5 10 128 254}] 254
        } -result 3

        test column_search-$type-lt-3.3 {
            Match on last element -not (when greater)
        } -body {
            tarray::column search -lt -not [newcolumn $type {5 10 128 255}] 254
        } -result 3

        test column_search-$type-lt-3.4 {
            Match in middle -not (equal)
        } -body {
            tarray::column search -lt -not [newcolumn $type {
                128 180 75 75 10 230 250
            }] 230
        } -result 5

        test column_search-$type-lt-3.5 {
            Match in middle -not (equal)
        } -body {
            tarray::column search -lt -not [newcolumn $type {
                128 180 75 75 10 230 250
            }] 150
        } -result 1

        test column_search-$type-lt-3.6 {
            Match -not -inline (equal)
        } -body {
            tarray::column search -lt -not -inline [newcolumn $type {
                28 18 100 100 75 10 230 250
            }] 100
        } -result 100 -match numeric

        test column_search-$type-lt-3.7 {
            Match -not -inline (greater)
        } -body {
            tarray::column search -lt -not -inline [newcolumn $type {
                28 18 110 75 10 230 250
            }] 100
        } -result 110 -match numeric

        test column_search-$type-lt-3.8 {
            Match -not -all (one element)
        } -body {
            tarray::column search -lt -not -all [newcolumn $type {
                28 180 70 75 128 230 128
            }] 230
        } -result [crep int {5}] -match column

        test column_search-$type-lt-3.9 {
            Match -all -not
        } -body {
            tarray::column search -lt -not -all [newcolumn $type {
                128 180 75 75 128 230 128
            }] 128
        } -result [crep int {0 1 4 5 6}] -match column

        test column_search-$type-lt-3.10 {
            Match -not -all -inline
        } -body {
            tarray::column search -lt -not -inline -all [newcolumn $type {
                28 180 75 75 128 230 128
            }] 128
        } -result [crep $type {180 128 230 128}] -match column

        test column_search-$type-lt-4.0 {
            Match on element -range
        } -body {
            tarray::column search -lt -range 1 [newcolumn $type {5 128 10 255}] 200
        } -result 1

        test column_search-$type-lt-4.1 {
            Match fail -range
        } -body {
            tarray::column search -lt -range 2 [newcolumn $type {5 10 128 254}] 50
        } -result -1

        test column_search-$type-lt-4.2 {
            Match -inline -range
        } -body {
            tarray::column search -lt -inline -range 3 [newcolumn $type {
                128 180 75 175 10 230 250
            }] 100
        } -result 10 -match numeric

        test column_search-$type-lt-4.3 {
            Match -all -range (one element)
        } -body {
            tarray::column search -lt -all -range 3 [newcolumn $type {
                128 180 70 125 128 20
            }] 100
        } -result [crep int {5}] -match column

        test column_search-$type-lt-4.4 {
            Match -all -range
        } -body {
            tarray::column search -lt -all -range 3 [newcolumn $type {
                128 180 75 75 128 230 128
            }] 180
        } -result [crep int {3 4 6}] -match column

        test column_search-$type-lt-4.5 {
            Match -all -inline -range
        } -body {
            tarray::column search -lt -all -inline -range 3 [newcolumn $type {
                28 180 75 75 128 30 128
            }] 128
        } -result [crep $type {75 30}] -match column

        test column_search-$type-lt-4.6 {
            Match -range -not
        } -body {
            tarray::column search -not -lt -range 3 [newcolumn $type {
                128 180 75 175 10 230 250
            }] 175
        } -result 3

        test column_search-$type-lt-4.7 {
            Match -inline -range -not -all
        } -body {
            tarray::column search -not -lt -all -inline -range 3 [newcolumn $type {
                128 180 75 175 10 230 250
            }] 200
        } -result [crep $type {230 250}] -match column

        test column_search-$type-lt-4.8 {
            Match -all -inline -range 0
        } -body {
            tarray::column search -lt -all -inline -range 0 [newcolumn $type {
                28 180 75 75 128 30 128
            }] 128
        } -result [crep $type {28 75 75 30}] -match column

        test column_search-$type-lt-4.9 {
            Match -all -inline -range out of bounds
        } -body {
            tarray::column search -lt -all -inline -range 100 [newcolumn $type {
                28 180 75 75 128 30 128
            }] 128
        } -result [crep $type {}] -match column

        test column_search-$type-lt-4.10 {
            Match -range end
        } -body {
            tarray::column search -lt -all -inline -range end [newcolumn $type {
                28 180 75 75 128 30 128
            }] 128
        } -result [crep $type {}] -match column

        test column_search-$type-lt-4.11 {
            Match -range end
        } -body {
            tarray::column search -lt -all -inline -range end [newcolumn $type {
                28 180 75 75 128 30 127
            }] 128
        } -result [crep $type {127}] -match column

        test column_search-$type-lt-4.12 {
            Match on element -range
        } -body {
            tarray::column search -lt -range {1 3} [newcolumn $type {5 128 10 255}] 200
        } -result 1

        test column_search-$type-lt-4.13 {
            Match fail -range
        } -body {
            tarray::column search -lt -range {2 end} [newcolumn $type {5 10 128 254}] 50
        } -result -1

        test column_search-$type-lt-4.14 {
            Match -inline -range
        } -body {
            tarray::column search -lt -inline -range {3 7} [newcolumn $type {
                128 180 75 175 10 230 250
            }] 100
        } -result 10 -match numeric

        test column_search-$type-lt-4.15 {
            Match -all -range (one element)
        } -body {
            tarray::column search -lt -all -range {3 end} [newcolumn $type {
                128 180 70 125 128 20
            }] 100
        } -result [crep int {5}] -match column

        test column_search-$type-lt-4.16 {
            Match -all -range
        } -body {
            tarray::column search -lt -all -range {3 5} [newcolumn $type {
                128 180 75 75 128 230 128
            }] 180
        } -result [crep int {3 4}] -match column

        test column_search-$type-lt-4.17 {
            Match -all -inline -range
        } -body {
            tarray::column search -lt -all -inline -range {0 3} [newcolumn $type {
                28 180 75 75 128 30 128
            }] 128
        } -result [crep $type {28 75 75}] -match column

        test column_search-$type-lt-4.18 {
            Match -range -not
        } -body {
            tarray::column search -not -lt -range {1 5} [newcolumn $type {
                128 170 75 175 10 230 250
            }] 175
        } -result 3

        test column_search-$type-lt-4.19 {
            Match -range -not
        } -body {
            tarray::column search -not -lt -all -range {1 5} [newcolumn $type {
                128 170 75 175 10 230 250
            }] 175
        } -result [crep int {3 5}] -match column

        test column_search-$type-lt-4.20 {
            Match -inline -range -not -all
        } -body {
            tarray::column search -not -lt -all -inline -range {0 5} [newcolumn $type {
                128 180 75 175 10 230 250
            }] 100
        } -result [crep $type {128 180 175 230}] -match column

        test column_search-$type-lt-4.21 {
            Match -all -inline -range 0 0
        } -body {
            tarray::column search -lt -all -inline -range {0 0} [newcolumn $type {
                28 180 75 75 128 30 128
            }] 128
        } -result [crep $type {28}] -match column

        test column_search-$type-lt-4.22 {
            Match -all -inline -range out of bounds
        } -body {
            tarray::column search -lt -all -inline -range {7 100} [newcolumn $type {
                28 180 75 75 128 30 128
            }] 128
        } -result [crep $type {}] -match column

        test column_search-$type-lt-4.23 {
            Match -range end
        } -body {
            tarray::column search -lt -all -inline -range {end end} [newcolumn $type {
                28 180 75 75 128 30 128
            }] 128
        } -result [crep $type {}] -match column

        test column_search-$type-lt-4.24 {
            Match -range end
        } -body {
            tarray::column search -lt -all -inline -range {end end} [newcolumn $type {
                28 180 75 75 128 30 127
            }] 128
        } -result [crep $type {127}] -match column

        test column_search-$type-lt-4.25 {
            Match -range -inline (empty)
        } -body {
            tarray::column search -lt -range {0 end} [newcolumn $type {}] [samplevalue $type]
        } -result -1

        test column_search-$type-eq-4.26 {
            Match -range -inline (empty)
        } -body {
            tarray::column search -inline -lt -range {0 end} [newcolumn $type {}] [samplevalue $type]
        } -result {}

        test column_search-$type-eq-4.27 {
            Match -range -inline (reversed range)
        } -body {
            tarray::column search -inline -lt -range {end 0} [samplecolumn $type] [samplevalue $type]
        } -result {}

        test column_search-$type-eq-4.28 {
            Match -range (reversed range)
        } -body {
            tarray::column search -lt -range {10 0} [samplecolumn $type] [samplevalue $type]
        } -result -1

        test column_search-$type-lt-4.29 {
            Match on element -among
        } -body {
            tarray::column search -lt -among {1 3 4} [newcolumn $type {5 128 10 55 101}] 100
        } -result 3

        test column_search-$type-lt-4.30 {
            Match on element -among (fail)
        } -body {
            tarray::column search -lt -among {1 3 4} [newcolumn $type {5 128 10 55 101}] 10
        } -result -1

        test column_search-$type-lt-4.31 {
            Match -inline -among
        } -body {
            tarray::column search -lt -inline -among {1 3 4 7} [newcolumn $type {
                128 180 75 75 10 230 250
            }] 100
        } -result 75 -match numeric

        test column_search-$type-lt-4.32 {
            Match -inline -among out of order indices
        } -body {
            tarray::column search -lt -inline -among {1 4 3 7} [newcolumn $type {
                128 180 75 75 10 230 250
            }] 100
        } -result 10 -match numeric

        test column_search-$type-lt-4.33 {
            Match -all -among (negative and out of bounds indices)
        } -body {
            tarray::column search -lt -all -among {-1 3 5 7} [newcolumn $type {
                128 180 70 125 128 20 120
            }] 100
        } -result [crep int {5}] -match column

        test column_search-$type-lt-4.34 {
            Match -not -all -among -inline (negative and out of bounds indices)
        } -body {
            tarray::column search -inline -not -lt -all -among {-1 3 5 6 7} [newcolumn $type {
                128 180 70 100 128 20 120
            }] 100
        } -result [crep $type {100 120}] -match column

        test column_search-$type-lt-4.35 {
            Match -among -range -all
        } -body {
            tarray::column search -lt -all -range {1 5} -among {0 5 7 5 4} [newcolumn $type {
                128 170 75 175 10 30 250 100
            }] 175
        } -result [crep int {5 5 4}] -match column

        test column_search-$type-lt-4.36 {
            Match -among -range -inline -all
        } -body {
            tarray::column search -lt -inline -all -range {1 5} -among {0 5 7 5 4} [newcolumn $type {
                128 170 75 175 10 30 250 100
            }] 175
        } -result [crep $type {30 30 10}] -match column

        test column_search-$type-lt-4.37 {
            Match -among -range
        } -body {
            tarray::column search -lt -range {1 5} -among {0 5 7 5 4} [newcolumn $type {
                128 170 75 175 10 30 250 100
            }] 175
        } -result 5

        test column_search-$type-lt-4.38 {
            Match -among -range -inline
        } -body {
            tarray::column search -inline -lt -range {1 5} -among {0 4 5 7 } [newcolumn $type {
                128 170 75 175 10 30 250 100
            }] 175
        } -result 10 -match numeric

        test column_search-$type-lt-4.39 {
            Match -range -inline (empty)
        } -body {
            tarray::column search -lt -among {0 1} [newcolumn $type {}] [samplevalue $type]
        } -result -1

        test column_search-$type-eq-4.40 {
            Match -range -inline (empty)
        } -body {
            tarray::column search -inline -lt -among {0} [newcolumn $type {}] [samplevalue $type]
        } -result {}

        test column_search-$type-lt-4.41 {
            Match -among -range reversed
        } -body {
            tarray::column search -lt -range {5 0} -among {0 5 7 5 4} [newcolumn $type {
                128 170 75 175 10 30 250 100
            }] 175
        } -result -1

        test column_search-$type-lt-4.42 {
            Match -among empty
        } -body {
            tarray::column search -lt -among {} [newcolumn $type {
                128 170 75 175 10 30 250 100
            }] 175
        } -result -1

        test column_search-$type-lt-4.43 {
            Match -among empty
        } -body {
            tarray::column search -inline -lt -among {} [newcolumn $type {
                128 170 75 175 10 30 250 100
            }] 175
        } -result {}

        test column_search-$type-lt-4.44 {
            Match -among empty
        } -body {
            tarray::column search -all -lt -among {} [newcolumn $type {
                128 170 75 175 10 30 250 100
            }] 175
        } -result [crep int {}] -match column


        test column_search-$type-lt-5.0 {
            Match invalid value
        } -body {
            tarray::column search -lt [newcolumn $type {
                28 180 75 75 128 30 128
            }] nota$type
        } -returnCodes error -result "*expected*but got*" -match glob

        test column_search-$type-lt-6.0 {
            Match missing element
        } -body {
            tarray::column search -lt [newcolumn $type {10 11 12}] 1
        } -result -1

        test column_search-$type-lt-6.1 {
            Match missing element -inline
        } -body {
            tarray::column search -lt -inline [newcolumn $type {10 11 12}] 1
        } -result ""

        test column_search-$type-lt-6.2 {
            Match missing element -all
        } -body {
            tarray::column search -lt -all [newcolumn $type {10 11 12}] 1
        } -result [crep int {}] -match column

        test column_search-$type-lt-6.3 {
            Match missing element -not
        } -body {
            tarray::column search -lt -not [newcolumn $type {0 1 2}] 10
        } -result -1

        test column_search-$type-lt-6.4 {
            Match missing element -not -inline -all
        } -body {
            tarray::column search -not -lt -inline -all [newcolumn $type {0 1 2}] 111
        } -result [crep $type {}] -match column

        #
        # Numeric -gt tests
        test column_search-$type-gt-2.0 {
            Match on first element
        } -body {
            tarray::column search -gt [newcolumn $type {5 10 128 255}] 0
        } -result 0

        test column_search-$type-gt-2.1 {
            Match on last element
        } -body {
            tarray::column search -gt [newcolumn $type {10 11 12 99}] 50
        } -result 3

        test column_search-$type-gt-2.2 {
            Match in middle, unsorted list
        } -body {
            tarray::column search -gt [newcolumn $type {
                28 80 75 75 10 230 250
            }] 100
        } -result 5

        test column_search-$type-gt-2.3 {
            Match -inline
        } -body {
            tarray::column search -gt -inline [newcolumn $type {
                28 18 75 75 10 230 250
            }] 75
        } -result 230 -match numeric

        test column_search-$type-gt-2.3 {
            Match -all (one element)
        } -body {
            tarray::column search -gt -all [newcolumn $type {
                128 180 70 75 128 230 128
            }] 200
        } -result [crep int {5}] -match column

        test column_search-$type-gt-2.4 {
            Match -all
        } -body {
            tarray::column search -gt -all [newcolumn $type {
                128 180 75 75 128 230 228
            }] 150
        } -result [crep int {1 5 6}] -match column

        test column_search-$type-gt-2.5 {
            Match -all -inline
        } -body {
            tarray::column search -gt -all -inline [newcolumn $type {
                28 180 75 75 128 230 255
            }] 128
        } -result [crep $type {180 230 255}] -match column

        test column_search-$type-gt-3.0 {
            Match on first element -not (when equal)
        } -body {
            tarray::column search -gt -not [newcolumn $type {
                100 5 10 128 255
            }] 100
        } -result 0

        test column_search-$type-gt-3.1 {
            Match on first element -not (when less)
        } -body {
            tarray::column search -gt -not [newcolumn $type {
                110 5 10 128 255
            }] 120
        } -result 0

        test column_search-$type-gt-3.2 {
            Match on last element -not (when equal)
        } -body {
            tarray::column search -gt -not [newcolumn $type {5 10 128 1}] 1
        } -result 3

        test column_search-$type-gt-3.3 {
            Match on last element -not (when smaller)
        } -body {
            tarray::column search -gt -not [newcolumn $type {128 255 101 99}] 100
        } -result 3

        test column_search-$type-gt-3.4 {
            Match in middle -not (equal)
        } -body {
            tarray::column search -gt -not [newcolumn $type {
                128 180 75 75 10 230 250
            }] 75
        } -result 2

        test column_search-$type-gt-3.5 {
            Match in middle -not (smaller)
        } -body {
            tarray::column search -gt -not [newcolumn $type {
                128 180 75 75 10 230 250
            }] 100
        } -result 2

        test column_search-$type-gt-3.6 {
            Match -not -inline (equal)
        } -body {
            tarray::column search -gt -not -inline [newcolumn $type {
                128 118 100 100 75 10 230 250
            }] 100
        } -result 100 -match numeric

        test column_search-$type-gt-3.7 {
            Match -not -inline (smaller)
        } -body {
            tarray::column search -gt -not -inline [newcolumn $type {
                128 118 110 75 10 230 250
            }] 100
        } -result 75 -match numeric

        test column_search-$type-gt-3.8 {
            Match -not -all (one element)
        } -body {
            tarray::column search -gt -not -all [newcolumn $type {
                180 170 75 128 230 128
            }] 75
        } -result [crep int {2}] -match column

        test column_search-$type-gt-3.9 {
            Match -all -not
        } -body {
            tarray::column search -gt -not -all [newcolumn $type {
                128 180 75 75 128 230 128
            }] 128
        } -result [crep int {0 2 3 4 6}] -match column

        test column_search-$type-gt-3.10 {
            Match -not -all -inline
        } -body {
            tarray::column search -gt -not -inline -all [newcolumn $type {
                28 180 75 75 128 230 128
            }] 128
        } -result [crep $type {28 75 75 128 128}] -match column

        test column_search-$type-gt-4.0 {
            Match on element -range
        } -body {
            tarray::column search -gt -range 2 [newcolumn $type {5 128 10 255}] 100
        } -result 3

        test column_search-$type-gt-4.1 {
            Match fail -range
        } -body {
            tarray::column search -gt -range 2 [newcolumn $type {51 100 128 25}] 150
        } -result -1

        test column_search-$type-gt-4.2 {
            Match -inline -range
        } -body {
            tarray::column search -gt -inline -range 2 [newcolumn $type {
                28 80 75 175 10 230 250
            }] 75
        } -result 175 -match numeric

        test column_search-$type-gt-4.3 {
            Match -all -range (one element)
        } -body {
            tarray::column search -gt -all -range 3 [newcolumn $type {
                128 180 225 70 128 201
            }] 200
        } -result [crep int {5}] -match column

        test column_search-$type-gt-4.4 {
            Match -all -range
        } -body {
            tarray::column search -gt -all -range 2 [newcolumn $type {
                128 180 75 75 128 230 128
            }] 75
        } -result [crep int {4 5 6}] -match column

        test column_search-$type-gt-4.5 {
            Match -all -inline -range
        } -body {
            tarray::column search -gt -all -inline -range 2 [newcolumn $type {
                28 180 75 75 128 30 128
            }] 75
        } -result [crep $type {128 128}] -match column

        test column_search-$type-gt-4.6 {
            Match -range -not
        } -body {
            tarray::column search -not -gt -range 3 [newcolumn $type {
                128 180 75 175 10 30 250
            }] 175
        } -result 3

        test column_search-$type-gt-4.7 {
            Match -inline -range -not -all
        } -body {
            tarray::column search -not -gt -all -inline -range 2 [newcolumn $type {
                128 80 75 175 10 30 250
            }] 100
        } -result [crep $type {75 10 30}] -match column

        test column_search-$type-gt-4.8 {
            Match -all -inline -range 0
        } -body {
            tarray::column search -gt -all -inline -range 0 [newcolumn $type {
                28 180 75 75 128 30 129
            }] 128
        } -result [crep $type {180 129}] -match column

        test column_search-$type-gt-4.9 {
            Match -all -inline -range out of bounds
        } -body {
            tarray::column search -gt -all -inline -range 100 [newcolumn $type {
                28 180 75 75 128 30 128
            }] 128
        } -result [crep $type {}] -match column

        test column_search-$type-gt-4.10 {
            Match -range end
        } -body {
            tarray::column search -gt -all -inline -range end [newcolumn $type {
                28 180 75 75 128 30 128
            }] 128
        } -result [crep $type {}] -match column

        test column_search-$type-gt-4.11 {
            Match -range end
        } -body {
            tarray::column search -gt -all -inline -range end [newcolumn $type {
                28 180 75 75 128 30 128
            }] 127
        } -result [crep $type {128}] -match column

        test column_search-$type-gt-4.12 {
            Match on element -range
        } -body {
            tarray::column search -gt -range {2 end} [newcolumn $type {5 128 10 255}] 100
        } -result 3

        test column_search-$type-gt-4.13 {
            Match fail -range
        } -body {
            tarray::column search -gt -range {0 end} [newcolumn $type {51 100 128 25}] 150
        } -result -1

        test column_search-$type-gt-4.14 {
            Match -inline -range
        } -body {
            tarray::column search -gt -inline -range {2 5} [newcolumn $type {
                28 80 75 175 10 230 250
            }] 75
        } -result 175 -match numeric

        test column_search-$type-gt-4.15 {
            Match -all -range (one element)
        } -body {
            tarray::column search -gt -all -range {3 5} [newcolumn $type {
                128 180 225 70 128 201 220
            }] 200
        } -result [crep int {5}] -match column

        test column_search-$type-gt-4.16 {
            Match -all -range
        } -body {
            tarray::column search -gt -all -range {2 7} [newcolumn $type {
                128 180 75 75 128 230 128 50 200
            }] 75
        } -result [crep int {4 5 6}] -match column

        test column_search-$type-gt-4.17 {
            Match -all -inline -range
        } -body {
            tarray::column search -gt -all -inline -range {2 7} [newcolumn $type {
                28 180 75 75 128 30 128 100 200
            }] 75
        } -result [crep $type {128 128 100}] -match column

        test column_search-$type-gt-4.18 {
            Match -range -not
        } -body {
            tarray::column search -not -gt -range {3 6} [newcolumn $type {
                128 180 75 175 10 30 250 100
            }] 175
        } -result 3

        test column_search-$type-gt-4.19 {
            Match -inline -range -not -all
        } -body {
            tarray::column search -not -gt -all -inline -range {2 6} [newcolumn $type {
                128 80 75 175 10 30 250 90
            }] 100
        } -result [crep $type {75 10 30}] -match column

        test column_search-$type-gt-4.20 {
            Match -all -inline -range 0,0
        } -body {
            tarray::column search -gt -all -inline -range {0 0} [newcolumn $type {
                129 180 75 75 128 30 129
            }] 128
        } -result [crep $type {129}] -match column

        test column_search-$type-gt-4.21 {
            Match -all -inline -range end end
        } -body {
            tarray::column search -gt -all -range {end end} [newcolumn $type {
                129 180 75 75 128 30 129
            }] 128
        } -result [crep int {6}] -match column

        test column_search-$type-gt-4.22 {
            Match -all -inline -range out of bounds
        } -body {
            tarray::column search -gt -all -inline -range {7 100} [newcolumn $type {
                28 180 75 75 128 30 128
            }] 0
        } -result [crep $type {}] -match column

        test column_search-$type-gt-4.23 {
            Match -range end -inline (fail)
        } -body {
            tarray::column search -gt -all -inline -range {end end} [newcolumn $type {
                28 180 75 75 128 30 128
            }] 128
        } -result [crep $type {}] -match column

        test column_search-$type-gt-4.24 {
            Match -range end
        } -body {
            tarray::column search -gt -all -inline -range {end end} [newcolumn $type {
                28 180 75 75 128 30 128
            }] 127
        } -result [crep $type {128}] -match column

        test column_search-$type-gt-4.25 {
            Match on element -among
        } -body {
            tarray::column search -gt -among {1 3 4} [newcolumn $type {50 10 20 50 11}] 10
        } -result 3

        test column_search-$type-gt-4.26 {
            Match on element -among (fail)
        } -body {
            tarray::column search -gt -among {1 3 4} [newcolumn $type {5 50 200 55 100}] 100
        } -result -1

        test column_search-$type-gt-4.27 {
            Match -inline -among
        } -body {
            tarray::column search -gt -inline -among {1 3 4 7} [newcolumn $type {
                20 5 20 30 40 50
            }] 10
        } -result 30 -match numeric

        test column_search-$type-gt-4.28 {
            Match -inline -among out of order indices
        } -body {
            tarray::column search -gt -inline -among {1 4 3 7} [newcolumn $type {
                20 5 20 30 40 50
            }] 10
        } -result 40 -match numeric

        test column_search-$type-gt-4.29 {
            Match -all -among (negative and out of bounds indices)
        } -body {
            tarray::column search -gt -all -among {-1 3 5 7} [newcolumn $type {
                128 180 70 125 128 20 120
            }] 100
        } -result [crep int {3}] -match column

        test column_search-$type-gt-4.30 {
            Match -not -all -among -inline (negative and out of bounds indices)
        } -body {
            tarray::column search -inline -not -gt -all -among {-1 3 5 6 7} [newcolumn $type {
                128 180 70 100 128 20 120
            }] 100
        } -result [crep $type {100 20}] -match column

        test column_search-$type-gt-4.31 {
            Match -among -range -all
        } -body {
            tarray::column search -gt -all -range {1 5} -among {0 1 5 7 5 4} [newcolumn $type {
                11 20 10 30 5 50 60 5 70
            }] 10
        } -result [crep int {1 5 5}] -match column

        test column_search-$type-gt-4.32 {
            Match -among -range -inline -all
        } -body {
            tarray::column search -gt -inline -all -range {1 5} -among {0 5 7 5 4} [newcolumn $type {
                11 20 10 30 5 50 60 5 70
            }] 10
        } -result [crep $type {50 50}] -match column

        test column_search-$type-gt-4.33 {
            Match -among -range
        } -body {
            tarray::column search -gt -range {1 5} -among {0 5 4 7} [newcolumn $type {
                10 20 10 30 40 50 60 50 70
            }] 10
        } -result 5

        test column_search-$type-gt-4.34 {
            Match -among -range -inline
        } -body {
            tarray::column search -inline -gt -range {1 5} -among {0 4 5 7 } [newcolumn $type {
                10 20 10 30 40 50 60 50 70
            }] 10
        } -result 40 -match numeric

        test column_search-$type-gt-4.35 {
            Match -range -inline (empty)
        } -body {
            tarray::column search -gt -among {0 1} [newcolumn $type {}] [samplevalue $type]
        } -result -1

        test column_search-$type-gt-4.36 {
            Match -range -inline (empty)
        } -body {
            tarray::column search -inline -gt -among {0} [newcolumn $type {}] [samplevalue $type]
        } -result {}

        test column_search-$type-gt-4.37 {
            Match -among -range reversed
        } -body {
            tarray::column search -gt -range {5 0} -among {0 5 7 5 4} [newcolumn $type {
                20 30 40 50 60 70 80
            }] 10
        } -result -1

        test column_search-$type-gt-4.38 {
            Match -among empty
        } -body {
            tarray::column search -gt -among {} [newcolumn $type {
                128 170 75 175 10 30 250 100
            }] 0
        } -result -1

        test column_search-$type-gt-4.39 {
            Match -among empty
        } -body {
            tarray::column search -inline -gt -among {} [newcolumn $type {
                128 170 75 175 10 30 250 100
            }] 0
        } -result {}

        test column_search-$type-gt-4.40 {
            Match -among empty
        } -body {
            tarray::column search -all -gt -among {} [newcolumn $type {
                128 170 75 175 10 30 250 100
            }] 0
        } -result [crep int {}] -match column

        test column_search-$type-gt-5.0 {
            Match invalid value
        } -body {
            tarray::column search -gt [newcolumn $type {
                28 180 75 75 128 30 128
            }] nota$type
        } -returnCodes error -result "*expected*but got*" -match glob

        test column_search-$type-gt-6.0 {
            Match missing element
        } -body {
            tarray::column search -gt [newcolumn $type {10 11 12}] 100
        } -result -1

        test column_search-$type-gt-6.1 {
            Match missing element -inline
        } -body {
            tarray::column search -gt -inline [newcolumn $type {10 11 12}] 100
        } -result ""

        test column_search-$type-gt-6.2 {
            Match missing element -all
        } -body {
            tarray::column search -gt -all [newcolumn $type {10 11 12}] 100
        } -result [crep int {}] -match column

        test column_search-$type-gt-6.3 {
            Match missing element -not
        } -body {
            tarray::column search -gt -not [newcolumn $type {100 101 102}] 10
        } -result -1

        test column_search-$type-gt-6.4 {
            Match missing element -not -inline -all
        } -body {
            tarray::column search -not -gt -inline -all [newcolumn $type {100 101 102}] 10
        } -result [crep $type {}] -match column
    }

    # Above tests use values common to all integeral types. Add some tests
    # that use type specific values

    test column_search-byte-lt-7.0 {
        Match out of range  value
    } -body {
        tarray::column search -lt [newcolumn byte {
            28 180 75 75 128 30 128
        }] 256
    } -returnCodes error -result "Value '256' not valid for type byte*" -match glob

    test column_search-uint-lt-7.0 {
        Match UINT_MAX (verifying comparisons are unsigned)
    } -body {
        # Make sure 0x80000000 is treated as unsigned and not as -1
        tarray::column search -lt -all [newcolumn uint {0 0x80000000 2}] 10 
    } -result [crep int {0 2}] -match column

    test column_search-uint-lt-7.1 {
        Match UINT_MAX (verifying comparisons are unsigned)
    } -body {
        # Make sure 0x80000000 is treated as unsigned and not as -1
        tarray::column search -lt -not -inline [newcolumn uint {0 0x80000000 2}] 0x7fffffff
    } -result 2147483648

    test column_search-uint-lt-7.2 {
        Match out of range value
    } -body {
        tarray::column search -lt [newcolumn uint {
            28 180 75 75 128 30 128 
        }] 0x100000000
    } -returnCodes error -result "*'0x100000000' not valid for type uint*" -match glob

    test column_search-int-lt-7.0 {
        Match verifying comparisons are signed
    } -body {
        tarray::column search -lt -all -not [newcolumn int {0 -1 2 -2147483648}] 0
    } -result [crep int {0 2}] -match column

    test column_search-int-lt-7.1 {
        Match verifying comparisons are signed
    } -body {
        tarray::column search -lt -inline -all [newcolumn int {0 -1 2 -2147483648}] 0
    } -result [crep int {-1 -2147483648}] -match column

    test column_search-int-lt-7.2 {
        Match out of range value
    } -body {
        tarray::column search -lt -inline -all [newcolumn int {0 -1 2 -2147483648}] -549755813888
    } -returnCodes error -result "Value '-549755813888' not valid for type int*" -match glob

    test column_search-wide-lt-7.0 {
        Match verifying comparisons are signed
    } -body {
        tarray::column search -lt -all -not [newcolumn wide {0 -1 2 -2147483648 549755813888 -549755813888}] 0
    } -result [crep int {0 2 4}] -match column

    test column_search-wide-lt-7.1 {
        Match verifying comparisons are signed
    } -body {
        tarray::column search -lt -inline -all [newcolumn wide {0 -1 2 -2147483648 549755813888 -549755813888}] 0
    } -result [crep wide {-1 -2147483648 -549755813888}] -match column

    test column_search-wide-lt-7.2 {
        Match out of range value
    } -body {
        tarray::column search -lt -inline -all [newcolumn wide {0 -1 2 -2147483648}] 5497558138884584564356934856358
    } -returnCodes error -result "*too large*" -match glob

    test column_search-double-lt-7.0 {
        Match using exponent notation
    } -body {
        tarray::column search -lt -all -inline [newcolumn double {0 -1e-10 2.0 5e5 10.0e3}] 1e5
    } -result [crep double {0.0 -1e-10 2.0 10000.0}] -match column

    test column_search-double-lt-7.1 {
        Match using exponent notation
    } -body {
        tarray::column search -lt -all -not -inline [newcolumn double {0 -1e-10 2.0 5e5 1.0e3 5e20 5e-20}] 1e3
    } -result [crep double {500000.0 1000.0 5e+20}] -match column

    test column_search-byte-gt-7.0 {
        Match out of range  value
    } -body {
        tarray::column search -gt [newcolumn byte {
            28 180 75 75 128 30 128
        }] 256
    } -returnCodes error -result "Value '256' not valid for type byte*" -match glob

    test column_search-uint-gt-7.0 {
        Match UINT_MAX (verifying comparisons are unsigned)
    } -body {
        # Make sure 0x80000000 is treated as unsigned and not as -1
        tarray::column search -gt -all [newcolumn uint {0 0x80000000 100}] 10 
    } -result [crep int {1 2}] -match column

    test column_search-uint-gt-7.1 {
        Match UINT_MAX (verifying comparisons are unsigned)
    } -body {
        # Make sure 0x80000000 is treated as unsigned and not as -1
        tarray::column search -gt -not -inline [newcolumn uint {0x80000000 2}] 0x7fffffff
    } -result 2

    test column_search-uint-gt-7.2 {
        Match out of range value
    } -body {
        tarray::column search -gt [newcolumn uint {
            28 180 75 75 128 30 128 
        }] 0x100000000
    } -returnCodes error -result "*'0x100000000' not valid for type uint*" -match glob

    test column_search-int-gt-7.0 {
        Match verifying comparisons are signed
    } -body {
        tarray::column search -gt -all -not [newcolumn int {0 -10 2 -2147483648}] -10
    } -result [crep int {1 3}] -match column

    test column_search-int-gt-7.1 {
        Match verifying comparisons are signed
    } -body {
        tarray::column search -gt -inline -all [newcolumn int {10 -1 2 -2147483648}] 0
    } -result [crep int {10 2}] -match column

    test column_search-int-gt-7.2 {
        Match out of range value
    } -body {
        tarray::column search -gt -inline -all [newcolumn int {0 -1 2 -2147483648}] -549755813888
    } -returnCodes error -result "Value '-549755813888' not valid for type int*" -match glob

    test column_search-wide-gt-7.0 {
        Match verifying comparisons are signed
    } -body {
        tarray::column search -gt -all -not [newcolumn wide {0 -1 2 -2147483648 549755813888 -549755813888}] 0
    } -result [crep int {0 1 3 5}] -match column

    test column_search-wide-gt-7.1 {
        Match verifying comparisons are signed
    } -body {
        tarray::column search -gt -inline -all [newcolumn wide {0 -1 2 -2147483648 549755813888 -549755813888}] -2147483648
    } -result [crep wide {0 -1 2 549755813888}] -match column

    test column_search-wide-gt-7.2 {
        Match out of range value
    } -body {
        tarray::column search -gt -inline -all [newcolumn wide {0 -1 2 -2147483648}] 5497558138884584564356934856358
    } -returnCodes error -result "*too large*" -match glob

    test column_search-double-gt-7.0 {
        Match using exponent notation
    } -body {
        tarray::column search -gt -all -inline [newcolumn double {0 -1e-10 2.0 5e5 10.0e3}] 2.0
    } -result [crep double {5e5 10.0e3}] -match column

    test column_search-double-gt-7.1 {
        Match using exponent notation
    } -body {
        tarray::column search -gt -all -not -inline [newcolumn double {0 -1e-10 2.0 5e5 1.0e3 5e20 5e-20}] 1e3
    } -result [crep double {0.0 -1e-10 2.0 1000.0 5e-20}] -match column

    #
    # Boolean -eq test for -among option only
    # Remaining -eq tests were done earlier

    test column_search-boolean-eq-6.1 {
        Match on element -among
    } -body {
        tarray::column search -eq -among {1 3 4} [newcolumn boolean {
            1 0 1 1 1 1
        }] 1
    } -result 3

    test column_search-boolean-eq-6.2 {
        Match on element -among
    } -body {
        tarray::column search -eq -among {1 3 4} [newcolumn boolean {
            0 1 0 1 0 0 0
        }] 0
    } -result 4

    test column_search-boolean-eq-6.3 {
        Match on element -among (fail)
    } -body {
        tarray::column search -eq -among {1 3 4} [newcolumn boolean {
            0 1 0 1 1 0 1
        }] 0
    } -result -1

    test column_search-boolean-eq-6.4 {
        Match -inline -among
    } -body {
        tarray::column search -eq -inline -among {1 3 4 7} [newcolumn boolean {
            0 0 0 0 1 0 0
        }] 1
    } -result 1

    test column_search-boolean-eq-6.5 {
        Match -among out of order indices
    } -body {
        tarray::column search -eq -among {1 4 3 7} [newcolumn boolean {
            0 1 0 0 0 0 0
        }] 0
    } -result 4

    test column_search-boolean-eq-6.6 {
        Match -all -among (negative and out of bounds indices)
    } -body {
        tarray::column search -eq -all -among {-1 3 5 7} [newcolumn boolean {
            1 1 1 0 1 1 1
        }] 1
    } -result [crep int {5}] -match column

    test column_search-boolean-eq-6.7 {
        Match -among -range -all
    } -body {
        tarray::column search -eq -all -range {1 5} -among {0 3 5 7 5 4} [newcolumn boolean {
            0 0 0 1 0 0 0
        }] 0
    } -result [crep int {5 5 4}] -match column

    test column_search-boolean-eq-6.8 {
        Match -among -range -all -not
    } -body {
        tarray::column search -not -eq -all -range {1 5} -among {0 5 7 5 4} [newcolumn boolean {
            1 1 0 0 0 0 1 1 1
        }] 1
    } -result [crep int {5 5 4}] -match column

    test column_search-boolean-eq-6.9 {
        Match -among -inline (empty)
    } -body {
        tarray::column search -eq -among {0 1} [newcolumn boolean {}] [samplevalue boolean]
    } -result -1

    test column_search-boolean-eq-6.10 {
        Match -among -inline (empty)
    } -body {
        tarray::column search -inline -eq -among {0} [newcolumn boolean {}] [samplevalue boolean]
    } -result {}

    test column_search-boolean-eq-6.11 {
        Match -among -range reversed
    } -body {
        tarray::column search -eq -range {5 0} -among {0 1 2 3 4 5 6} [newcolumn boolean {
            0 0 0 0 0 0
        }] 0
    } -result -1

    test column_search-boolean-eq-6.12 {
        Match -among empty
    } -body {
        tarray::column search -eq -among {} [newcolumn boolean {
            1 1 1 1 1 1 1 1
        }] 1
    } -result -1

    test column_search-boolean-eq-6.13 {
        Match -among empty
    } -body {
        tarray::column search -inline -eq -among {} [newcolumn boolean {
            0 0 0 0 0 0 0
        }] 0
    } -result {}

    test column_search-boolean-eq-6.14 {
        Match -among empty
    } -body {
        tarray::column search -all -eq -among {} [newcolumn boolean {
            1 1 1 1 1 1
        }] 1
    } -result [crep int {}] -match column

    #
    # Now do the "any" type, not -eq we have already done except for -among.

    #
    # any -eq -among
    test column_search-any-eq-6.1 {
        Match on element -among
    } -body {
        tarray::column search -eq -among {1 3 4} [newcolumn any {
            a b c a e f
        }] a
    } -result 3

    test column_search-any-eq-6.2 {
        Match on element -among (fail)
    } -body {
        tarray::column search -eq -among {1 3 4} [newcolumn any {
            a b c d e a
        }] a
    } -result -1

    test column_search-any-eq-6.3 {
        Match -inline -among
    } -body {
        tarray::column search -nocase -eq -inline -among {1 3 4 7} [newcolumn any {
            a b a A a a
        }] a
    } -result A

    test column_search-any-eq-6.4 {
        Match -among out of order indices
    } -body {
        tarray::column search -eq -among {1 4 3 7} [newcolumn any {
            a b a a a a
        }] a
    } -result 4

    test column_search-any-eq-6.5 {
        Match -all -among (negative and out of bounds indices)
    } -body {
        tarray::column search -eq -all -among {-1 3 5 7} [newcolumn any {
            a A c A a a a
        }] a
    } -result [crep int {5}] -match column

    test column_search-any-eq-6.6 {
        Match -not -all -among -inline (negative and out of bounds indices)
    } -body {
        tarray::column search -inline -nocase -not -eq -all -among {-1 3 5 6 7} [newcolumn any {
            a b x X e f g x
        }] x
    } -result [crep any {f g}] -match column

    test column_search-any-eq-6.7 {
        Match -among -range -all
    } -body {
        tarray::column search -nocase -eq -all -range {1 5} -among {0 5 7 5 4} [newcolumn any {
            a x x x X x x x
        }] x
    } -result [crep int {5 5 4}] -match column

    test column_search-any-eq-6.8 {
        Match -among -range -inline -all -not
    } -body {
        tarray::column search -not -eq -inline -all -range {1 5} -among {0 5 7 5 4} [newcolumn any {
            a x x e X f g x
        }] x
    } -result [crep any {f f X}] -match column

    test column_search-any-eq-6.9 {
        Match -among -range
    } -body {
        tarray::column search -nocase -eq -range {1 5} -among {0 5 7 5 4} [newcolumn any {
            a x x x x X x
        }] x
    } -result 5

    test column_search-any-eq-6.10 {
        Match -among -range -inline -not
    } -body {
        tarray::column search -inline -not -eq -range {1 5} -among {0 4 5 7 } [newcolumn any {
            a b c d a f g
        }] a
    } -result f

    test column_search-any-eq-6.11 {
        Match -among (empty)
    } -body {
        tarray::column search -eq -among {0 1} [newcolumn any {}] x
    } -result -1

    test column_search-any-eq-6.12 {
        Match -among -inline (empty)
    } -body {
        tarray::column search -inline -eq -among {0} [newcolumn any {}] x
    } -result {}

    test column_search-any-eq-6.13 {
        Match -among -range reversed
    } -body {
        tarray::column search -eq -range {5 0} -among {0 1 2 3 4 5 6} [newcolumn any {
            x x x x
        }] x
    } -result -1

    test column_search-any-eq-6.14 {
        Match -among empty
    } -body {
        tarray::column search -eq -among {} [newcolumn any {
            x x x x x
        }] x
    } -result -1

    test column_search-any-eq-6.15 {
        Match -among -inline empty
    } -body {
        tarray::column search -inline -eq -among {} [newcolumn any {
            x x x x x
        }] x
    } -result {}

    test column_search-any-eq-6.16 {
        Match -among -all empty
    } -body {
        tarray::column search -all -eq -among {} [newcolumn any {
            x x x x x
        }] x
    } -result [crep int {}] -match column

    #
    # any -lt
    test column_search-any-lt-2.0 {
        Find first match
    } -body {
        tarray::column search -lt [newcolumn any {first {with spaces} { leading space} UPPERCASE 10 5.0e5}] abc
    } -result 2

    test column_search-any-lt-2.1 {
        Match on last element
    } -body {
        tarray::column search -lt [newcolumn any {first {with spaces} AAA { leading space} AAA 5.0e5}] ABC
    } -result 2

    test column_search-any-lt-2.2 {
        Match -inline
    } -body {
        tarray::column search -lt -inline [newcolumn any {
            first {with spaces} { leading space} AAA 5.0e5
        }] abc
    } -result { leading space}

    test column_search-any-lt-2.3 {
        Match -all (one element)
    } -body {
        tarray::column search -lt -all [newcolumn any {
            first {with spaces} { leading space} " AAA" zzz
        }] " aaa"
    } -result [crep int {3}] -match column

    test column_search-any-lt-2.4 {
        Match -all
    } -body {
        tarray::column search -lt -all [newcolumn any {
            first { leading space} {with spaces} AAA 5.0e5
        }] aaa
    } -result [crep int {1 3 4}] -match column
    
    test column_search-any-lt-2.5 {
        Match -all -inline
    } -body {
        tarray::column search -lt -all -inline [newcolumn any {
            first { leading space} {with spaces} AAA 5.0e5
        }] AAA
    } -result [crep any {{ leading space} 5.0e5}] -match column

    test column_search-any-lt-2.6 {
        Verify comparisons are strings, not numeric
    } -body {
        tarray::column search -lt [newcolumn any {010 1}] 2
    } -result 0

    test column_search-any-lt-3.0 {
        Match -not (equal)
    } -body {
        tarray::column search -not -lt [newcolumn any {ABC second {with spaces} AAA { leading space} AAA 5.0e5}] ABC
    } -result 0

    test column_search-any-lt-3.1 {
        Match on element -not -inline (when greater)
    } -body {
        tarray::column search -not -lt -inline [newcolumn any {{with spaces} ABA { leading space} AAA 5.0e5}] ABC
    } -result {with spaces}

    test column_search-any-lt-3.2 {
        Match on last element -not (when equal)
    } -body {
        tarray::column search -not -lt [newcolumn any {{with spaces} ABA { leading space} AAA 5.0e5 zzz}] zzz
    } -result 5

    test column_search-any-lt-3.3 {
        Match on element -not
    } -body {
        tarray::column search -not -lt [newcolumn any {{with spaces} ABA { leading space} AAA 5.0e5 zzz}] zzz
    } -result 5

    test column_search-any-lt-3.4 {
        Match in middle -not -all
    } -body {
        tarray::column search -not -lt -all [newcolumn any {{with spaces} aaa ABA { leading space} AAA 5.0e5 zzz}] aaa
    } -result [crep int {0 1 6}] -match column

    test column_search-any-lt-3.5 {
        Match in middle -not -inline -all
    } -body {
        tarray::column search -not -lt -inline -all [newcolumn any {{with spaces} aaa ABA { leading space} AAA 5.0e5 zzz}] aaa
    } -result [crep any {{with spaces} aaa zzz}] -match column

    test column_search-any-lt-3.6 {
        Verify comparisons are strings, not numeric (-not -inline)
    } -body {
        tarray::column search -not -lt -inline -all [newcolumn any {010 1 0 10}] 00
    } -result [crep any {010 1 10}] -match column

    test column_search-any-lt-4.0 {
        Match on element -range
    } -body {
        tarray::column search -lt -range 1 [newcolumn any {aaa zzz bbb ccc ddd}] zzz
    } -result 2

    test column_search-any-lt-4.1 {
        Match fail -range
    } -body {
        tarray::column search -lt -range 1 [newcolumn any {aaa zzz bbb ccc ddd}] bbb
    } -result -1

    test column_search-any-lt-4.2 {
        Match -inline -range
    } -body {
        tarray::column search -lt -range 1 -inline [newcolumn any {aaa zzz bbb ccc ddd}] zzz
    } -result bbb

    test column_search-any-lt-4.3 {
        Match -all -range (one element)
    } -body {
        tarray::column search -lt -range 1 -all [newcolumn any {aaa zzz bbb ccc ddd}] ccc
    } -result [crep int {2}] -match column

    test column_search-any-lt-4.4 {
        Match -all -range
    } -body {
        tarray::column search -lt -range 2 -all [newcolumn any {aaa zzz bbb eee ccc ddd}] ddd
    } -result [crep int {2 4}] -match column

    test column_search-any-lt-4.5 {
        Match -all -inline -range
    } -body {
        tarray::column search -lt -range 2 -all -inline [newcolumn any {aaa zzz bbb eee ccc ddd}] ddd
    } -result [crep any {bbb ccc}] -match column

    test column_search-any-lt-4.6 {
        Match -range -not
    } -body {
        tarray::column search -not -lt -range 2 [newcolumn any {aaa zzz bbb eee ccc ddd}] bbb
    } -result 2

    test column_search-any-lt-4.7 {
        Match -inline -range -not -all
    } -body {
        tarray::column search -not -lt -range 2 -all -inline [newcolumn any {aaa zzz bbb eee ccc ddd}] ccc
    } -result [crep any {eee ccc ddd}] -match column

    test column_search-any-lt-4.8 {
        Match -all -inline -range 
    } -body {
        tarray::column search -lt -range 0 -inline -all [newcolumn any {aaa zzz bbb eee ccc ddd}] ccc
    } -result [crep any {aaa bbb}] -match column

    test column_search-any-lt-4.9 {
        Match -all -inline -range out of bounds
    } -body {
        tarray::column search -lt -range 10 -inline -all [newcolumn any {aaa zzz bbb eee ccc}] ccc
    } -result [crep any {}] -match column

    test column_search-any-lt-4.10 {
        Match -range end
    } -body {
        tarray::column search -lt -range end -inline [newcolumn any {aaa zzz bbb eee ccc}] ccc
    } -result {}

    test column_search-any-lt-4.11 {
        Match on element -range
    } -body {
        tarray::column search -lt -range {1 end} [newcolumn any {aaa zzz bbb ccc ddd}] zzz
    } -result 2

    test column_search-any-lt-4.12 {
        Match fail -range
    } -body {
        tarray::column search -lt -range {1 4} [newcolumn any {aaa zzz bbb ccc ddd aaa}] bbb
    } -result -1

    test column_search-any-lt-4.13 {
        Match -inline -range
    } -body {
        tarray::column search -lt -range {1 4} -inline [newcolumn any {aaa zzz bbb ccc ddd}] zzz
    } -result bbb

    test column_search-any-lt-4.14 {
        Match -all -range (one element)
    } -body {
        tarray::column search -lt -range {1 4} -all [newcolumn any {aaa zzz bbb ccc ddd}] ccc
    } -result [crep int {2}] -match column

    test column_search-any-lt-4.15 {
        Match -all -range
    } -body {
        tarray::column search -lt -range {2 5} -all [newcolumn any {aaa zzz bbb eee ccc ddd ccc}] ddd
    } -result [crep int {2 4}] -match column

    test column_search-any-lt-4.16 {
        Match -all -inline -range
    } -body {
        tarray::column search -lt -range {2 5} -all -inline [newcolumn any {aaa zzz bbb eee ccc ddd ccc}] ddd
    } -result [crep any {bbb ccc}] -match column

    test column_search-any-lt-4.17 {
        Match -range -not
    } -body {
        tarray::column search -not -lt -range {2 4} [newcolumn any {aaa zzz bbb eee ccc ddd}] bbb
    } -result 2

    test column_search-any-lt-4.18 {
        Match -inline -range -not -all
    } -body {
        tarray::column search -not -lt -range {2 6} -all -inline [newcolumn any {aaa zzz bbb eee ccc ddd bbb eee}] ccc
    } -result [crep any {eee ccc ddd}] -match column

    test column_search-any-lt-4.19 {
        Match -all -inline -range 
    } -body {
        tarray::column search -lt -range {0 5} -inline -all [newcolumn any {aaa zzz bbb eee ccc ddd aaa}] ccc
    } -result [crep any {aaa bbb}] -match column

    test column_search-any-lt-4.20 {
        Match -all -inline -range out of bounds
    } -body {
        tarray::column search -lt -range {5 10} -inline -all [newcolumn any {aaa zzz bbb eee bbb}] ccc
    } -result [crep any {}] -match column

    test column_search-any-lt-4.21 {
        Match -range end
    } -body {
        tarray::column search -lt -range {end end} -inline [newcolumn any {aaa zzz bbb eee aaa}] ccc
    } -result aaa

    test column_search-any-lt-4.22 {
        Match -range end
    } -body {
        tarray::column search -lt -range {end 0} [newcolumn any {aaa zzz bbb eee aaa}] ccc
    } -result -1

    test column_search-any-lt-4.23 {
        Match on element -among
    } -body {
        tarray::column search -lt -among {1 3 4} [newcolumn any {a d c d e f}] e
    } -result 1

    test column_search-any-lt-4.24 {
        Match on element -among (fail)
    } -body {
        tarray::column search -lt -among {1 3 4} [newcolumn any {a e b e e f}] e
    } -result -1

    test column_search-any-lt-4.25 {
        Match -inline -among
    } -body {
        tarray::column search -lt -inline -among {1 3 4 7} [newcolumn any {
            a z c d e f g b
        }] f
    } -result d

    test column_search-any-lt-4.26 {
        Match -inline -among out of order indices
    } -body {
        tarray::column search -lt -inline -among {1 4 3 7} [newcolumn any {
            a z c d e f g b
        }] f
    } -result e

    test column_search-any-lt-4.27 {
        Match -all -among (negative and out of bounds indices)
    } -body {
        tarray::column search -lt -all -among {-1 3 5 7} [newcolumn any {
            a z c z e f g
        }] g
    } -result [crep int {5}] -match column

    test column_search-any-lt-4.28 {
        Match -not -all -among -inline (negative and out of bounds indices)
    } -body {
        tarray::column search -inline -not -lt -all -among {-1 3 5 6 7} [newcolumn any {
            a z c d e f c
        }] c
    } -result [crep any {d f c}] -match column

    test column_search-any-lt-4.29 {
        Match -among -range -all
    } -body {
        tarray::column search -lt -all -range {1 5} -among {0 5 7 5 4} [newcolumn any {
            z c D e F c d z
        }] g
    } -result [crep int {5 5 4}] -match column

    test column_search-any-lt-4.30 {
        Match -among -range -inline -all
    } -body {
        tarray::column search -lt -inline -all -range {1 5} -among {0 5 7 5 4} [newcolumn any {
            z c D e F c d z
        }] g
    } -result [crep any {c c F}] -match column

    test column_search-any-lt-4.31 {
        Match -among -range
    } -body {
        tarray::column search -lt -range {1 5} -among {0 5 7 5 4} [newcolumn any {
            z c D e F c d z
        }] g
    } -result 5

    test column_search-any-lt-4.32 {
        Match -among -range -inline
    } -body {
        tarray::column search -inline -lt -range {1 5} -among {0 4 5 7 } [newcolumn any {
            a c D e F c d z
        }] g
    } -result F -match numeric

    test column_search-any-lt-4.33 {
        Match -range -inline (empty)
    } -body {
        tarray::column search -lt -among {0 1} [newcolumn any {}] xxx
    } -result -1

    test column_search-any-lt-4.34 {
        Match -range -inline (empty)
    } -body {
        tarray::column search -inline -lt -among {0} [newcolumn any {}] xxx
    } -result {}

    test column_search-any-lt-4.35 {
        Match -among -range reversed
    } -body {
        tarray::column search -lt -range {5 0} -among {0 5 7 5 4} [newcolumn any {
            aaa aaa aaa
        }] aaa
    } -result -1

    test column_search-any-lt-4.36 {
        Match -among empty
    } -body {
        tarray::column search -lt -among {} [newcolumn any {
            aaa aaa aaa
        }] aaa
    } -result -1

    test column_search-any-lt-4.37 {
        Match -among -inline empty
    } -body {
        tarray::column search -inline -lt -among {} [newcolumn any {
            aaa aaa aaa
        }] aaa
    } -result {}

    test column_search-any-lt-4.44 {
        Match -among -all empty
    } -body {
        tarray::column search -all -lt -among {} [newcolumn any {
            aaa aaa aaa
        }] aaa
    } -result [crep int {}] -match column

    test column_search-any-lt-6.0 {
        Match missing element
    } -body {
        tarray::column search -lt [newcolumn any {aaa zzz bbb eee ccc}] aaa
    } -result -1

    test column_search-any-lt-6.1 {
        Match missing element -inline
    } -body {
        tarray::column search -lt -inline [newcolumn any {aaa zzz bbb eee ccc}] aaa
    } -result ""

    test column_search-any-lt-6.2 {
        Match missing element -all
    } -body {
        tarray::column search -lt -all [newcolumn any {aaa zzz bbb eee ccc}] aaa
    } -result [crep int {}] -match column

    test column_search-any-lt-6.3 {
        Match missing element -not
    } -body {
        tarray::column search -lt -not [newcolumn any {aaa bbb eee ccc}] zzz
    } -result -1

    test column_search-any-lt-6.4 {
        Match missing element -not -inline -all
    } -body {
        tarray::column search -lt -not -inline -all [newcolumn any {aaa bbb eee ccc}] zzz
    } -result [crep any {}] -match column

    #
    # -gt

    test column_search-any-gt-2.0 {
        Find first match
    } -body {
        tarray::column search -gt [newcolumn any {first {with spaces} { leading space} UPPERCASE 10 5.0e5}] abc
    } -result 0

    test column_search-any-gt-2.1 {
        Match on last element
    } -body {
        tarray::column search -gt [newcolumn any {first {with spaces} AAA { leading space} AAA 5.0e5 zzz}] yyy
    } -result 6

    test column_search-any-gt-2.2 {
        Match -inline
    } -body {
        tarray::column search -gt -inline [newcolumn any {
            abc {with spaces} { leading space} AAA 5.0e5
        }] abc
    } -result {with spaces}

    test column_search-any-gt-2.3 {
        Match -all (one element)
    } -body {
        tarray::column search -gt -all [newcolumn any {
            first {with spaces} { leading space} " AAA"
        }] w
    } -result [crep int {1}] -match column

    test column_search-any-gt-2.4 {
        Match -all
    } -body {
        tarray::column search -gt -all [newcolumn any {
            first { leading space} {with spaces} AAA 5.0e5
        }] aaa
    } -result [crep int {0 2}] -match column
    
    test column_search-any-gt-2.5 {
        Match -all -inline
    } -body {
        tarray::column search -gt -all -inline [newcolumn any {
            first { leading space} {with spaces} AAA 5.0e5
        }] AAA
    } -result [crep any {first {with spaces}}] -match column

    test column_search-any-gt-2.6 {
        Verify comparisons are strings, not numeric
    } -body {
        tarray::column search -gt [newcolumn any {21 1}] 200
    } -result 0

    test column_search-any-gt-3.0 {
        Match -not (equal)
    } -body {
        tarray::column search -not -gt [newcolumn any {ABC second {with spaces} AAA { leading space} AAA 5.0e5}] ABC
    } -result 0

    test column_search-any-gt-3.1 {
        Match on element -not -inline (when greater)
    } -body {
        tarray::column search -not -gt -inline [newcolumn any {{with spaces} ABA { leading space} AAA 5.0e5}] ABC
    } -result {ABA}

    test column_search-any-gt-3.2 {
        Match on last element -not (when equal)
    } -body {
        tarray::column search -not -gt [newcolumn any {first {with spaces} ABA AAA 5.0e5}] 5.0e5
    } -result 4

    test column_search-any-gt-3.4 {
        Match in middle -not -all
    } -body {
        tarray::column search -not -gt -all [newcolumn any {{with spaces} aaa ABA { leading space} AAA 5.0e5 zzz}] aaa
    } -result [crep int {1 2 3 4 5}] -match column

    test column_search-any-gt-3.5 {
        Match in middle -not -inline -all
    } -body {
        tarray::column search -not -gt -inline -all [newcolumn any {{with spaces} aaa ABA { leading space} AAA 5.0e5 zzz}] aaa
    } -result [crep any {aaa ABA { leading space} AAA 5.0e5}] -match column

    test column_search-any-gt-3.6 {
        Verify comparisons are strings, not numeric (-not -inline)
    } -body {
        tarray::column search -not -gt -inline -all [newcolumn any {010 1 0}] 1
    } -result [crep any {010 1 0}] -match column

    test column_search-any-gt-4.0 {
        Match on element -range
    } -body {
        tarray::column search -gt -range 1 [newcolumn any {aaa bbb ccc ddd}] bbb
    } -result 2

    test column_search-any-gt-4.1 {
        Match fail -range
    } -body {
        tarray::column search -gt -range 1 [newcolumn any {zzz bbb ccc ddd}] ddd
    } -result -1

    test column_search-any-gt-4.2 {
        Match -inline -range
    } -body {
        tarray::column search -gt -range 2 -inline [newcolumn any {aaa zzz bbb ccc ddd}] ccc
    } -result ddd

    test column_search-any-gt-4.3 {
        Match -all -range (one element)
    } -body {
        tarray::column search -gt -range 2 -all [newcolumn any {aaa zzz bbb ccc ddd}] ccc
    } -result [crep int {4}] -match column

    test column_search-any-gt-4.4 {
        Match -all -range
    } -body {
        tarray::column search -gt -range 2 -all [newcolumn any {aaa zzz bbb eee ccc ddd}] ccc
    } -result [crep int {3 5}] -match column

    test column_search-any-gt-4.5 {
        Match -all -inline -range
    } -body {
        tarray::column search -gt -range 2 -all -inline [newcolumn any {aaa zzz bbb eee ccc ddd}] ccc
    } -result [crep any {eee ddd}] -match column

    test column_search-any-gt-4.6 {
        Match -range -not
    } -body {
        tarray::column search -not -gt -range 1 [newcolumn any {aaa zzz bbb eee ccc ddd}] bbb
    } -result 2

    test column_search-any-gt-4.7 {
        Match -inline -range -not -all
    } -body {
        tarray::column search -not -gt -range 2 -all -inline [newcolumn any {aaa zzz bbb eee ccc ddd}] ccc
    } -result [crep any {bbb ccc}] -match column

    test column_search-any-gt-4.8 {
        Match -all -inline -range 0
    } -body {
        tarray::column search -gt -range 0 -inline -all [newcolumn any {aaa zzz bbb eee ccc ddd}] ccc
    } -result [crep any {zzz eee ddd}] -match column

    test column_search-any-gt-4.9 {
        Match -all -inline -range out of bounds
    } -body {
        tarray::column search -gt -range 10 -inline -all [newcolumn any {aaa zzz bbb eee ccc}] ccc
    } -result [crep any {}] -match column

    test column_search-any-gt-4.10 {
        Match -range end
    } -body {
        tarray::column search -gt -range end -inline [newcolumn any {aaa zzz bbb eee ccc}] ccc
    } -result {}

    test column_search-any-gt-4.11 {
        Match on element -range
    } -body {
        tarray::column search -gt -range {1 end} [newcolumn any {aaa bbb ccc ddd}] bbb
    } -result 2

    test column_search-any-gt-4.12 {
        Match fail -range
    } -body {
        tarray::column search -gt -range {1 end} [newcolumn any {zzz bbb ccc ddd}] ddd
    } -result -1

    test column_search-any-gt-4.14 {
        Match -all -range (one element)
    } -body {
        tarray::column search -gt -range {2 6} -all [newcolumn any {aaa zzz bbb ccc ddd bbb aaa fff}] ccc
    } -result [crep int {4}] -match column

    test column_search-any-gt-4.15 {
        Match -all -range
    } -body {
        tarray::column search -gt -range {2 6} -all [newcolumn any {aaa zzz bbb eee ccc ddd aaa qqq}] ccc
    } -result [crep int {3 5}] -match column

    test column_search-any-gt-4.16 {
        Match -all -inline -range
    } -body {
        tarray::column search -gt -range {2 6} -all -inline [newcolumn any {aaa zzz bbb eee ccc ddd aaa fff}] ccc
    } -result [crep any {eee ddd}] -match column

    test column_search-any-gt-4.17 {
        Match -range -not
    } -body {
        tarray::column search -not -gt -range {1 end} [newcolumn any {aaa zzz bbb eee ccc ddd}] bbb
    } -result 2

    test column_search-any-gt-4.18 {
        Match -inline -range -not -all
    } -body {
        tarray::column search -not -gt -range {2 5} -all -inline [newcolumn any {aaa zzz bbb eee ccc ddd aaa}] ccc
    } -result [crep any {bbb ccc}] -match column

    test column_search-any-gt-4.19 {
        Match -all -inline -range out of bounds
    } -body {
        tarray::column search -gt -range {10 20} -inline -all [newcolumn any {aaa zzz bbb eee ccc}] ccc
    } -result [crep any {}] -match column

    test column_search-any-gt-4.20 {
        Match -range end
    } -body {
        tarray::column search -gt -range {end  end} -inline [newcolumn any {aaa zzz bbb eee ccc ddd}] ccc
    } -result {ddd}

    test column_search-any-gt-4.22 {
        Match -range end
    } -body {
        tarray::column search -lt -range {end 0} -inline [newcolumn any {aaa zzz bbb eee aaa}] ccc
    } -result {}

    test column_search-any-gt-4.23 {
        Match -range end
    } -body {
        tarray::column search -lt -range {end 0} -inline -all [newcolumn any {aaa zzz bbb eee aaa}] ccc
    } -result [crep any {}] -match column

    test column_search-any-gt-4.24 {
        Match on element -among
    } -body {
        tarray::column search -gt -among {1 3 4} [newcolumn any {
            e b c d e f
        }] b
    } -result 3

    test column_search-any-gt-4.25 {
        Match on element -among (fail)
    } -body {
        tarray::column search -gt -among {1 3 4} [newcolumn any {
            e a e d c f
        }] d
    } -result -1

    test column_search-any-gt-4.26 {
        Match -inline -among
    } -body {
        tarray::column search -gt -inline -among {1 3 4 7} [newcolumn any {
            e b c d e f
        }] b
    } -result d

    test column_search-any-gt-4.27 {
        Match -inline -among out of order indices
    } -body {
        tarray::column search -gt -inline -among {1 4 3 7} [newcolumn any {
            e b c d e f
        }] b
    } -result e

    test column_search-any-gt-4.28 {
        Match -all -among (negative and out of bounds indices)
    } -body {
        tarray::column search -gt -all -among {-1 3 5 7} [newcolumn any {
            b b b a b b b
        }] a
    } -result [crep int {5}] -match column

    test column_search-any-gt-4.29 {
        Match -not -all -among -inline (negative and out of bounds indices)
    } -body {
        tarray::column search -inline -not -gt -all -among {-1 3 5 6 7} [newcolumn any {
            a b c d c f e
        }] e
    } -result [crep any {d e}] -match column

    test column_search-any-gt-4.30 {
        Match -among -range -all
    } -body {
        tarray::column search -gt -all -range {1 5} -among {0 1 5 7 5 4} [newcolumn any {
            f z g c h i j a a
        }] e
    } -result [crep int {1 5 5 4}] -match column

    test column_search-any-gt-4.31 {
        Match -among -range -all -inline
    } -body {
        tarray::column search -gt -all -inline -range {1 5} -among {0 1 5 7 5 4} [newcolumn any {
            f z g c h i j a a
        }] e
    } -result [crep any {z i i h}] -match column

    test column_search-any-gt-4.32 {
        Match -among -range
    } -body {
        tarray::column search -gt -range {1 5} -among {0 5 4 7} [newcolumn any {
            g A b c F a b c d 
        }] E
    } -result 5

    test column_search-any-gt-4.33 {
        Match -among -range -inline
    } -body {
        tarray::column search -inline -gt -range {1 5} -among {0 4 5 7 } [newcolumn any {
            g A b c d A b c d 
        }] E
    } -result d

    test column_search-any-gt-4.34 {
        Match -range -inline (empty)
    } -body {
        tarray::column search -gt -among {0 1} [newcolumn any {}] aaa
    } -result -1

    test column_search-any-gt-4.35 {
        Match -range -inline (empty)
    } -body {
        tarray::column search -inline -gt -among {0} [newcolumn any {}] aaa
    } -result {}

    test column_search-any-gt-4.36 {
        Match -among -range reversed
    } -body {
        tarray::column search -gt -range {5 0} -among {0 5 7 5 4} [newcolumn any {
            b b b b b b b b b
        }] a
    } -result -1

    test column_search-any-gt-4.37 {
        Match -among empty
    } -body {
        tarray::column search -gt -among {} [newcolumn any {
            b b b b b b b 
        }] a
    } -result -1

    test column_search-any-gt-4.38 {
        Match -among -inline empty
    } -body {
        tarray::column search -inline -gt -among {} [newcolumn any {
            b b b b b 
        }] a
    } -result {}

    test column_search-any-gt-4.39 {
        Match -among -all empty
    } -body {
        tarray::column search -all -gt -among {} [newcolumn any {
            b b b b b 
        }] a
    } -result [crep int {}] -match column

    test column_search-any-gt-6.0 {
        Match missing element
    } -body {
        tarray::column search -gt [newcolumn any {aaa bbb eee ccc}] xxx
    } -result -1

    test column_search-any-gt-6.1 {
        Match missing element -inline
    } -body {
        tarray::column search -gt -inline [newcolumn any {aaa zzz bbb eee ccc}] zzz
    } -result ""

    test column_search-any-gt-6.2 {
        Match missing element -all
    } -body {
        tarray::column search -gt -all [newcolumn any {aaa zzz bbb eee ccc}] zzz
    } -result [crep int {}] -match column

    test column_search-any-gt-6.3 {
        Match missing element -not
    } -body {
        tarray::column search -gt -not [newcolumn any {zzz bbb eee ccc}] aaa
    } -result -1

    test column_search-any-gt-6.4 {
        Match missing element -not -inline -all
    } -body {
        tarray::column search -gt -not -inline -all [newcolumn any {zzz bbb eee ccc}] aaa
    } -result [crep any {}] -match column

    #
    # -pat

    test column_search-any-pat-1.0 {
        Search empty column
    } -body {
        tarray::column search -pat [newcolumn any {}] *
    } -result -1

    test column_search-any-pat-1.1 {
        Search empty column
    } -body {
        tarray::column search -pat -inline [newcolumn any {}] *
    } -result {}

    test column_search-any-pat-2.0 {
        Match on first element
    } -body {
        tarray::column search -pat [newcolumn any {abc def hij}] *
    } -result 0

    test column_search-any-pat-2.1 {
        Match on first element -inline 
    } -body {
        tarray::column search -inline -pat [newcolumn any {abc def hij}] *
    } -result abc

    test column_search-any-pat-2.2 {
        Match on last element 
    } -body {
        tarray::column search -pat [newcolumn any {abc def hij}] h*
    } -result 2

    test column_search-any-pat-2.3 {
        Match on last element 
    } -body {
        tarray::column search -pat -inline [newcolumn any {abc def hij}] *j
    } -result hij

    test column_search-any-pat-2.4 {
        Match -all (one element)
    } -body {
        tarray::column search -pat -all [newcolumn any {
            first {with spaces} { leading space} " AAA" 
        }] *A*
    } -result [crep int {3}] -match column

    test column_search-any-pat-2.5 {
        Match -all
    } -body {
        tarray::column search -pat -all [newcolumn any {
            first { leading space} {with spaces} AAA 5.0e5
        }] "* *"
    } -result [crep int {1 2}] -match column
    
    test column_search-any-pat-2.6 {
        Match -all -inline
    } -body {
        tarray::column search -pat -all -inline [newcolumn any {
            first { leading space} {with spaces} AAA 5.0e5
        }] *s*
    } -result [crep any {first { leading space} {with spaces}}] -match column

    test column_search-any-pat-3.0 {
        Match -not
    } -body {
        tarray::column search -not -pat [newcolumn any {aaa bbb ccc ddd eee}] a*
    } -result 1

    test column_search-any-pat-3.1 {
        Match on element -not -inline
    } -body {
        tarray::column search -not -pat -inline [newcolumn any {abc acb bca bac cab cba}] *c
    } -result acb

    test column_search-any-pat-3.2 {
        Match on element -not -all
    } -body {
        tarray::column search -not -pat -all [newcolumn any {abc acb bca bac cab cba}] *c
    } -result [crep int {1 2 4 5}] -match column

    test column_search-any-pat-3.3 {
        Match on element -not -all -inline
    } -body {
        tarray::column search -not -pat -all -inline [newcolumn any {abc acb bca bac cab cba}] *c
    } -result [crep any {acb bca cab cba}] -match column

    test column_search-any-pat-4.0 {
        Match on element -range
    } -body {
        tarray::column search -pat -range 2 [newcolumn any {abc acb bca bac cab cba}] *c
    } -result 3

    test column_search-any-pat-4.1 {
        Match fail -range
    } -body {
        tarray::column search -pat -range 1 [newcolumn any {zzz bbb ccc ddd}] a*
    } -result -1

    test column_search-any-pat-4.2 {
        Match -inline -range
    } -body {
        tarray::column search -pat -range 2 -inline [newcolumn any {abc acb bca bac cab cba}] *c
    } -result bac

    test column_search-any-pat-4.3 {
        Match -all -range
    } -body {
        tarray::column search -all -pat -range 2 [newcolumn any {abc acb bca bac cab cba dcb}] *c?
    } -result [crep int {2 6}] -match column

    test column_search-any-pat-4.4 {
        Match -all -inline -range
    } -body {
        tarray::column search -all -pat -range 2 -inline [newcolumn any {abc acb bca bac cab cba}] *c?
    } -result [crep any {bca}] -match column

    test column_search-any-pat-4.5 {
        Match -range -not
    } -body {
        tarray::column search -not -pat -range 2 [newcolumn any {abc acb bca bac cab cba}] *c?
    } -result 3

    test column_search-any-pat-4.6 {
        Match -inline -range -not -all
    } -body {
        tarray::column search -not -all -pat -range 2 -inline [newcolumn any {abc acb bca bac cab cba}] *c?
    } -result [crep any {bac cab cba}] -match column

    test column_search-any-pat-4.7 {
        Match -all -inline -range 0
    } -body {
        tarray::column search -all -pat -range 0 -inline [newcolumn any {abc acb bca bac cab cba}] *c?
    } -result [crep any {acb bca}] -match column

    test column_search-any-pat-4.8 {
        Match -all -inline -range out of bounds
    } -body {
        tarray::column search -pat -range 10 -inline -all [newcolumn any {aaa zzz bbb eee ccc}] c*
    } -result [crep any {}] -match column

    test column_search-any-pat-4.9 {
        Match on element -range
    } -body {
        tarray::column search -pat -range {2 end} [newcolumn any {abc acb bca bac cab cba}] *c
    } -result 3

    test column_search-any-pat-4.10 {
        Match fail -range
    } -body {
        tarray::column search -pat -range {1 3} [newcolumn any {zzz bbb ccc ddd aaa}] a*
    } -result -1

    test column_search-any-pat-4.11 {
        Match -inline -range
    } -body {
        tarray::column search -pat -range {2 5} -inline [newcolumn any {abc acb bca bac cab cba}] *c
    } -result bac

    test column_search-any-pat-4.12 {
        Match -all -range
    } -body {
        tarray::column search -all -pat -range {2 6} [newcolumn any {abc acb bca bac cab cba dcb dcb}] *c?
    } -result [crep int {2 6}] -match column

    test column_search-any-pat-4.13 {
        Match -all -inline -range
    } -body {
        tarray::column search -all -pat -range {2 5} -inline [newcolumn any {abc acb bca bac cab cba bca}] *c?
    } -result [crep any {bca}] -match column

    test column_search-any-pat-4.14 {
        Match -range -not
    } -body {
        tarray::column search -not -pat -range {2 5} [newcolumn any {abc acb bca bac cab cba}] *c?
    } -result 3

    test column_search-any-pat-4.15 {
        Match -inline -range -not -all
    } -body {
        tarray::column search -not -all -pat -range {2 5} -inline [newcolumn any {abc acb bca bac cab cba cba}] *c?
    } -result [crep any {bac cab cba}] -match column

    test column_search-any-pat-4.16 {
        Match -all -inline -range out of bounds
    } -body {
        tarray::column search -pat -range {5 10} -inline -all [newcolumn any {aaa zzz bbb eee ccc}] c*
    } -result [crep any {}] -match column

    test column_search-any-pat-4.17 {
        Match -all -range reverse
    } -body {
        tarray::column search -pat -range {end 0} -inline -all [newcolumn any {aaa zzz bbb eee ccc}] c*
    } -result [crep any {}] -match column

    test column_search-any-pat-4.18 {
        Match -all -range reverse
    } -body {
        tarray::column search -pat -range {end 0} -all [newcolumn any {aaa zzz bbb eee ccc}] c*
    } -result [crep int {}] -match column

    test column_search-any-pat-4.19 {
        Match on element -among
    } -body {
        tarray::column search -pat -among {1 3 4} [newcolumn any {
            aaa bbb aaa abc def a
        }] a*
    } -result 3

    test column_search-any-pat-4.20 {
        Match on element -among (fail)
    } -body {
        tarray::column search -pat -among {1 3 4} [newcolumn any {
            aaa bbb aaa bc def a
        }] a*
    } -result -1

    test column_search-any-pat-4.21 {
        Match -inline -among
    } -body {
        tarray::column search -pat -inline -among {1 3 4 7} [newcolumn any {
            a ba ab abc abd
        }] a*
    } -result abc

    test column_search-any-pat-4.22 {
        Match -among out of order indices
    } -body {
        tarray::column search -nocase -pat -among {1 4 3 7} [newcolumn any {
            a b ab abc ABC a a
        }] a*
    } -result 4

    test column_search-any-pat-4.23 {
        Match -all -among (negative and out of bounds indices)
    } -body {
        tarray::column search -pat -all -among {-1 3 5 7} [newcolumn any {
            ab A c A ab ad a da
        }] a*
    } -result [crep int {5}] -match column

    test column_search-any-pat-4.24 {
        Match -not -all -among -inline (negative and out of bounds indices)
    } -body {
        tarray::column search -inline -nocase -not -pat -all -among {-1 3 5 6 7} [newcolumn any {
            a b x X e f g x
        }] x*
    } -result [crep any {f g}] -match column

    test column_search-any-pat-4.25 {
        Match -among -range -all
    } -body {
        tarray::column search -nocase -pat -all -range {1 5} -among {0 5 7 5 4} [newcolumn any {
            a xy xy xy XY xy xy xy
        }] x*
    } -result [crep int {5 5 4}] -match column

    test column_search-any-pat-4.26 {
        Match -among -range -inline -all -not
    } -body {
        tarray::column search -not -pat -inline -all -range {1 5} -among {0 5 7 5 4} [newcolumn any {
            a x x e X f g x
        }] x*
    } -result [crep any {f f X}] -match column

    test column_search-any-pat-4.27 {
        Match -among -range
    } -body {
        tarray::column search -nocase -pat -range {1 5} -among {0 5 7 5 4} [newcolumn any {
            a x x x x X x
        }] x*
    } -result 5

    test column_search-any-pat-4.28 {
        Match -among -range -inline -not
    } -body {
        tarray::column search -inline -not -pat -range {1 5} -among {0 4 5 7 } [newcolumn any {
            a b c d a f g
        }] a*
    } -result f

    test column_search-any-pat-4.29 {
        Match -among (empty)
    } -body {
        tarray::column search -pat -among {0 1} [newcolumn any {}] x*
    } -result -1

    test column_search-any-pat-4.30 {
        Match -among -inline (empty)
    } -body {
        tarray::column search -inline -pat -among {0} [newcolumn any {}] x*
    } -result {}

    test column_search-any-pat-4.31 {
        Match -among -range reversed
    } -body {
        tarray::column search -pat -range {5 0} -among {0 1 2 3 4 5 6} [newcolumn any {
            x x x x
        }] x*
    } -result -1

    test column_search-any-pat-4.32 {
        Match -among empty
    } -body {
        tarray::column search -pat -among {} [newcolumn any {
            x x x x x
        }] x
    } -result -1

    test column_search-any-pat-4.33 {
        Match -among -inline empty
    } -body {
        tarray::column search -inline -pat -among {} [newcolumn any {
            x x x x x
        }] x
    } -result {}

    test column_search-any-pat-4.34 {
        Match -among -all empty
    } -body {
        tarray::column search -all -pat -among {} [newcolumn any {
            x x x x x
        }] x
    } -result [crep int {}] -match column

    test column_search-any-pat-5.0 {
        Match missing element
    } -body {
        tarray::column search -pat [newcolumn any {aaa zzz bbb eee ccc}] s*
    } -result -1

    test column_search-any-pat-5.1 {
        Match missing element -inline
    } -body {
        tarray::column search -pat -inline [newcolumn any {aaa zzz bbb eee ccc}] x*
    } -result ""

    test column_search-any-pat-5.2 {
        Match missing element -all
    } -body {
        tarray::column search -pat -all [newcolumn any {aaa zzz bbb eee ccc}] *x
    } -result [crep int {}] -match column

    test column_search-any-pat-5.3 {
        Match missing element -not
    } -body {
        tarray::column search -pat -not [newcolumn any {abc aaa a12}] a*
    } -result -1

    test column_search-any-pat-5.4 {
        Match missing element -not -inline -all
    } -body {
        tarray::column search -pat -not -inline -all [newcolumn any {abc aaa a12}] a*
    } -result [crep any {}] -match column


    #
    # -re

    test column_search-any-re-1.0 {
        Search empty column
    } -body {
        tarray::column search -re [newcolumn any {}] .*
    } -result -1

    test column_search-any-re-1.1 {
        Search empty column
    } -body {
        tarray::column search -re -inline [newcolumn any {}] .*
    } -result {}

    test column_search-any-re-2.0 {
        Match on first element
    } -body {
        tarray::column search -re [newcolumn any {abc def hij}] {a..$}
    } -result 0

    test column_search-any-re-2.1 {
        Match on first element -inline 
    } -body {
        tarray::column search -inline -re [newcolumn any {abc def hij}] ^a
    } -result abc

    test column_search-any-re-2.2 {
        Match on last element 
    } -body {
        tarray::column search -re [newcolumn any {abc def hij}] h
    } -result 2

    test column_search-any-re-2.3 {
        Match on last element 
    } -body {
        tarray::column search -re -inline [newcolumn any {abc def hij}] j\$
    } -result hij

    test column_search-any-re-2.4 {
        Match -all (one element)
    } -body {
        tarray::column search -re -all [newcolumn any {
            a b c d e
        }] d
    } -result [crep int {3}] -match column

    test column_search-any-re-2.5 {
        Match -all
    } -body {
        tarray::column search -re -all [newcolumn any {
            first { leading space} {with spaces} AAA 5.0e5
        }] "space"
    } -result [crep int {1 2}] -match column
    
    test column_search-any-re-2.6 {
        Match -all -inline
    } -body {
        tarray::column search -re -all -inline [newcolumn any {
            first { leading space} {with spaces} AAA 5.0e5
        }] space
    } -result [crep any {{ leading space} {with spaces}}] -match column

    test column_search-any-re-3.0 {
        Match -not
    } -body {
        tarray::column search -not -re [newcolumn any {aaa bbb ccc ddd eee}] a
    } -result 1

    test column_search-any-re-3.1 {
        Match on element -not -inline
    } -body {
        tarray::column search -not -re -inline [newcolumn any {abc acb bca bac cab cba}] .c
    } -result cab

    test column_search-any-re-3.2 {
        Match on element -not -all
    } -body {
        tarray::column search -not -re -all [newcolumn any {abc acb bca bac cab cba}] c.
    } -result [crep int {0 3}] -match column

    test column_search-any-re-3.3 {
        Match on element -not -all -inline
    } -body {
        tarray::column search -not -re -all -inline [newcolumn any {abc acb bca bac cab cba}]  c..
    } -result [crep any {abc acb bca bac}] -match column

    test column_search-any-re-4.0 {
        Match on element -range
    } -body {
        tarray::column search -re -range 2 [newcolumn any {abc acb bca bac cab cba}] ..c
    } -result 3

    test column_search-any-re-4.1 {
        Match fail -range
    } -body {
        tarray::column search -re -range 1 [newcolumn any {zzz bbb ccc ddd}] a
    } -result -1

    test column_search-any-re-4.2 {
        Match -inline -range
    } -body {
        tarray::column search -re -range 2 -inline [newcolumn any {abc acb bca bac cab cba}] ..c
    } -result bac

    test column_search-any-re-4.3 {
        Match -all -range
    } -body {
        tarray::column search -all -re -range 2 [newcolumn any {abc acb bca bac cab cba dcb}] c.
    } -result [crep int {2 4 5 6}] -match column

    test column_search-any-re-4.4 {
        Match -all -inline -range
    } -body {
        tarray::column search -all -re -range 2 -inline [newcolumn any {abc acb bca bac cab cba}] ac
    } -result [crep any {bac}] -match column

    test column_search-any-re-4.5 {
        Match -range -not
    } -body {
        tarray::column search -not -re -range 2 [newcolumn any {abc acb bca bac cab cba}] b.*c
    } -result 4

    test column_search-any-re-4.6 {
        Match -inline -range -not -all
    } -body {
        tarray::column search -not -all -re -range 2 -inline [newcolumn any {abc acb bca bac cab cba}] b.
    } -result [crep any {cab}] -match column

    test column_search-any-re-4.7 {
        Match -all -inline -range 0
    } -body {
        tarray::column search -all -re -range 0 -inline [newcolumn any {abc acb bca bac cab cba}] c.
    } -result [crep any {acb bca cab cba}] -match column

    test column_search-any-re-4.8 {
        Match -all -inline -range out of bounds
    } -body {
        tarray::column search -re -range 10 -inline -all [newcolumn any {aaa zzz bbb eee ccc}] c
    } -result [crep any {}] -match column

    test column_search-any-re-4.9 {
        Match on element -range
    } -body {
        tarray::column search -re -range {2 end} [newcolumn any {abc acb bca bac cab cba}] ..c
    } -result 3

    test column_search-any-re-4.10 {
        Match fail -range
    } -body {
        tarray::column search -re -range {1 3} [newcolumn any {zzz bbb ccc ddd a}] a
    } -result -1

    test column_search-any-re-4.11 {
        Match -inline -range (fail)
    } -body {
        tarray::column search -re -range {2 5} -inline [newcolumn any {abc bac xxx yyy zzz acb bca bac cab}] ..c
    } -result {}

    test column_search-any-re-4.12 {
        Match -range
    } -body {
        tarray::column search -re -range {2 5} [newcolumn any {abc bac xxx ccc zzz acb bca bac cab}] ..c
    } -result 3

    test column_search-any-re-4.13 {
        Match -all -range
    } -body {
        tarray::column search -all -re -range {2 5} [newcolumn any {abc acb bca bac cab cba dcb}] c.
    } -result [crep int {2 4 5}] -match column

    test column_search-any-re-4.14 {
        Match -all -inline -range
    } -body {
        tarray::column search -all -re -range {2 5} -inline [newcolumn any {abc acb bca bac cab cba ac}] ac
    } -result [crep any {bac}] -match column

    test column_search-any-re-4.15 {
        Match -inline -range -not -all
    } -body {
        tarray::column search -not -all -re -range {2 6} -inline [newcolumn any {abc acb bca bac cab cba acb cab}] b.
    } -result [crep any {cab acb}] -match column

    test column_search-any-re-4.16 {
        Match -all -inline -range out of bounds
    } -body {
        tarray::column search -re -range {5 10} -inline -all [newcolumn any {aaa zzz bbb eee ccc}] c
    } -result [crep any {}] -match column

    test column_search-any-re-4.17 {
        Match -all -inline -range reverse
    } -body {
        tarray::column search -re -range {3 1} -inline -all [newcolumn any {aaa zzz bbb eee ccc}] .
    } -result [crep any {}] -match column

    test column_search-any-re-4.19 {
        Match on element -among
    } -body {
        tarray::column search -re -among {1 3 4} [newcolumn any {
            aaa bbb aaa abc def a
        }] a.*
    } -result 3

    test column_search-any-re-4.20 {
        Match on element -among (fail)
    } -body {
        tarray::column search -re -among {1 3 4} [newcolumn any {
            aaa bbb aaa bc def a
        }] a.*
    } -result -1

    test column_search-any-re-4.21 {
        Match -inline -among
    } -body {
        tarray::column search -re -inline -among {1 3 4 7} [newcolumn any {
            a b ab abc abd
        }] a.*
    } -result abc

    test column_search-any-re-4.22 {
        Match -among out of order indices
    } -body {
        tarray::column search -nocase -re -among {1 4 3 7} [newcolumn any {
            a b ab abc ABC a a
        }] a.*
    } -result 4

    test column_search-any-re-4.23 {
        Match -all -among (negative and out of bounds indices)
    } -body {
        tarray::column search -re -all -among {-1 3 5 7} [newcolumn any {
            ab A c A ab ad a b
        }] a.*
    } -result [crep int {5}] -match column

    test column_search-any-re-4.24 {
        Match -not -all -among -inline (negative and out of bounds indices)
    } -body {
        tarray::column search -inline -nocase -not -re -all -among {-1 3 5 6 7} [newcolumn any {
            a b x X e f g x
        }] x.*
    } -result [crep any {f g}] -match column

    test column_search-any-re-4.25 {
        Match -among -range -all
    } -body {
        tarray::column search -nocase -re -all -range {1 5} -among {0 5 7 5 4} [newcolumn any {
            a xy xy xy XY xy xy xy
        }] x.*
    } -result [crep int {5 5 4}] -match column

    test column_search-any-re-4.26 {
        Match -among -range -inline -all -not
    } -body {
        tarray::column search -not -re -inline -all -range {1 5} -among {0 5 7 5 4} [newcolumn any {
            a x x e X f g x
        }] x.*
    } -result [crep any {f f X}] -match column

    test column_search-any-re-4.27 {
        Match -among -range
    } -body {
        tarray::column search -nocase -re -range {1 5} -among {0 5 7 5 4} [newcolumn any {
            a x x x x X x
        }] x.*
    } -result 5

    test column_search-any-re-4.28 {
        Match -among -range -inline -not
    } -body {
        tarray::column search -inline -not -re -range {1 5} -among {0 4 5 7 } [newcolumn any {
            a b c d a f g
        }] a.*
    } -result f

    test column_search-any-re-4.29 {
        Match -among (empty)
    } -body {
        tarray::column search -re -among {0 1} [newcolumn any {}] x.*
    } -result -1

    test column_search-any-re-4.30 {
        Match -among -inline (empty)
    } -body {
        tarray::column search -inline -re -among {0} [newcolumn any {}] x.*
    } -result {}

    test column_search-any-re-4.31 {
        Match -among -range reversed
    } -body {
        tarray::column search -re -range {5 0} -among {0 1 2 3 4 5 6} [newcolumn any {
            x x x x
        }] x.*
    } -result -1

    test column_search-any-re-4.32 {
        Match -among empty
    } -body {
        tarray::column search -re -among {} [newcolumn any {
            x x x x x
        }] x
    } -result -1

    test column_search-any-re-4.33 {
        Match -among -inline empty
    } -body {
        tarray::column search -inline -re -among {} [newcolumn any {
            x x x x x
        }] x
    } -result {}

    test column_search-any-re-4.34 {
        Match -among -all empty
    } -body {
        tarray::column search -all -re -among {} [newcolumn any {
            x x x x x
        }] x
    } -result [crep int {}] -match column

    test column_search-any-re-5.0 {
        Match missing element
    } -body {
        tarray::column search -re [newcolumn any {aaa zzz bbb eee ccc}] s
    } -result -1

    test column_search-any-re-5.1 {
        Match missing element -inline
    } -body {
        tarray::column search -re -inline [newcolumn any {aaa zzz bbb eee ccc}] x
    } -result ""

    test column_search-any-re-5.2 {
        Match missing element -all
    } -body {
        tarray::column search -re -all [newcolumn any {aaa zzz bbb eee ccc}] x
    } -result [crep int {}] -match column

    test column_search-any-re-5.3 {
        Match missing element -not
    } -body {
        tarray::column search -re -not [newcolumn any {abc aaa a12}] a
    } -result -1

    test column_search-any-re-5.4 {
        Match missing element -not -inline -all
    } -body {
        tarray::column search -re -not -inline -all [newcolumn any {abc aaa a12}] a
    } -result [crep any {}] -match column

    #
    # -nocase

    test column_search-any-eq-nocase-1.0 {
        Verify case sensitivity without -nocase
    } -body {
        tarray::column search -eq [newcolumn any {aaa AAA aaa AAA}] AAA
    } -result 1

    test column_search-any-eq-nocase-1.1 {
        Verify case sensitivity without -nocase
    } -body {
        tarray::column search -eq -range 1 [newcolumn any {aaa AAA aaa AAA}] aaa
    } -result 2

    test column_search-any-eq-nocase-2.0 {
        Verify case insensitivity with -nocase
    } -body {
        tarray::column search -eq -nocase [newcolumn any {aaa AAA aaa AAA}] AAA
    } -result 0

    test column_search-any-eq-nocase-2.1 {
        Verify case insensitivity with -nocase
    } -body {
        tarray::column search -eq -nocase -range 1 [newcolumn any {aaa AAA aaa AAA}] aaa
    } -result 1

    test column_search-any-pat-nocase-1.0 {
        Verify case sensitivity without -nocase
    } -body {
        tarray::column search -pat [newcolumn any {aaa AAA aaa AAA}] A*
    } -result 1

    test column_search-any-pat-nocase-1.1 {
        Verify case sensitivity without -nocase
    } -body {
        tarray::column search -pat -range 1 [newcolumn any {aaa AAA aaa AAA}] a*
    } -result 2

    test column_search-any-pat-nocase-2.0 {
        Verify case insensitivity with -nocase
    } -body {
        tarray::column search -pat -nocase [newcolumn any {aaa AAA aaa AAA}] A*
    } -result 0

    test column_search-any-pat-nocase-2.1 {
        Verify case insensitivity with -nocase
    } -body {
        tarray::column search -pat -nocase -range 1 [newcolumn any {aaa AAA aaa AAA}] a*
    } -result 1

    test column_search-any-re-nocase-1.0 {
        Verify case sensitivity without -nocase
    } -body {
        tarray::column search -re [newcolumn any {aaa AAA aaa AAA}] A
    } -result 1

    test column_search-any-re-nocase-1.1 {
        Verify case sensitivity without -nocase
    } -body {
        tarray::column search -re -range 1 [newcolumn any {aaa AAA aaa AAA}] a
    } -result 2

    test column_search-any-re-nocase-2.0 {
        Verify case insensitivity with -nocase
    } -body {
        tarray::column search -re -nocase [newcolumn any {aaa AAA aaa AAA}] A
    } -result 0

    test column_search-any-re-nocase-2.1 {
        Verify case insensitivity with -nocase
    } -body {
        tarray::column search -re -nocase -range 1 [newcolumn any {aaa AAA aaa AAA}] a
    } -result 1

    test column_search-any-lt-nocase-1.0 {
        Verify case sensitivity without -nocase
    } -body {
        tarray::column search -lt [newcolumn any {aBd aba}] abc
    } -result 0

    test column_search-any-lt-nocase-1.1 {
        Verify case sensitivity without -nocase
    } -body {
        tarray::column search -lt [newcolumn any {aBd aba}] Abc
    } -result -1

    test column_search-any-lt-nocase-2.0 {
        Verify case insensitivity with -nocase
    } -body {
        tarray::column search -lt -nocase [newcolumn any {aBd aba}] abc
    } -result 1

    test column_search-any-lt-nocase-2.1 {
        Verify case insensitivity with -nocase
    } -body {
        tarray::column search -lt -nocase [newcolumn any {abd aba}] Abc
    } -result 1

    test column_search-any-gt-nocase-1.0 {
        Verify case sensitivity without -nocase
    } -body {
        tarray::column search -gt [newcolumn any {aBd abe}] abc
    } -result 1

    test column_search-any-gt-nocase-1.1 {
        Verify case sensitivity without -nocase
    } -body {
        tarray::column search -gt [newcolumn any {aBb aba}] Abc
    } -result 0

    test column_search-any-gt-nocase-2.0 {
        Verify case insensitivity with -nocase
    } -body {
        tarray::column search -gt -nocase [newcolumn any {aBd abe}] abc
    } -result 0

    test column_search-any-gt-nocase-2.1 {
        Verify case insensitivity with -nocase
    } -body {
        tarray::column search -gt -nocase [newcolumn any {aba abd}] Abc
    } -result 1

    #
    # string -eq -among
    test column_search-string-eq-6.1 {
        Match on element -among
    } -body {
        tarray::column search -eq -among {1 3 4} [newcolumn string {
            a b c a e f
        }] a
    } -result 3

    test column_search-string-eq-6.2 {
        Match on element -among (fail)
    } -body {
        tarray::column search -eq -among {1 3 4} [newcolumn string {
            a b c d e a
        }] a
    } -result -1

    test column_search-string-eq-6.3 {
        Match -inline -among
    } -body {
        tarray::column search -nocase -eq -inline -among {1 3 4 7} [newcolumn string {
            a b a A a a
        }] a
    } -result A

    test column_search-string-eq-6.4 {
        Match -among out of order indices
    } -body {
        tarray::column search -eq -among {1 4 3 7} [newcolumn string {
            a b a a a a
        }] a
    } -result 4

    test column_search-string-eq-6.5 {
        Match -all -among (negative and out of bounds indices)
    } -body {
        tarray::column search -eq -all -among {-1 3 5 7} [newcolumn string {
            a A c A a a a
        }] a
    } -result [crep int {5}] -match column

    test column_search-string-eq-6.6 {
        Match -not -all -among -inline (negative and out of bounds indices)
    } -body {
        tarray::column search -inline -nocase -not -eq -all -among {-1 3 5 6 7} [newcolumn string {
            a b x X e f g x
        }] x
    } -result [crep string {f g}] -match column

    test column_search-string-eq-6.7 {
        Match -among -range -all
    } -body {
        tarray::column search -nocase -eq -all -range {1 5} -among {0 5 7 5 4} [newcolumn string {
            a x x x X x x x
        }] x
    } -result [crep int {5 5 4}] -match column

    test column_search-string-eq-6.8 {
        Match -among -range -inline -all -not
    } -body {
        tarray::column search -not -eq -inline -all -range {1 5} -among {0 5 7 5 4} [newcolumn string {
            a x x e X f g x
        }] x
    } -result [crep string {f f X}] -match column

    test column_search-string-eq-6.9 {
        Match -among -range
    } -body {
        tarray::column search -nocase -eq -range {1 5} -among {0 5 7 5 4} [newcolumn string {
            a x x x x X x
        }] x
    } -result 5

    test column_search-string-eq-6.10 {
        Match -among -range -inline -not
    } -body {
        tarray::column search -inline -not -eq -range {1 5} -among {0 4 5 7 } [newcolumn string {
            a b c d a f g
        }] a
    } -result f

    test column_search-string-eq-6.11 {
        Match -among (empty)
    } -body {
        tarray::column search -eq -among {0 1} [newcolumn string {}] x
    } -result -1

    test column_search-string-eq-6.12 {
        Match -among -inline (empty)
    } -body {
        tarray::column search -inline -eq -among {0} [newcolumn string {}] x
    } -result {}

    test column_search-string-eq-6.13 {
        Match -among -range reversed
    } -body {
        tarray::column search -eq -range {5 0} -among {0 1 2 3 4 5 6} [newcolumn string {
            x x x x
        }] x
    } -result -1

    test column_search-string-eq-6.14 {
        Match -among empty
    } -body {
        tarray::column search -eq -among {} [newcolumn string {
            x x x x x
        }] x
    } -result -1

    test column_search-string-eq-6.15 {
        Match -among -inline empty
    } -body {
        tarray::column search -inline -eq -among {} [newcolumn string {
            x x x x x
        }] x
    } -result {}

    test column_search-string-eq-6.16 {
        Match -among -all empty
    } -body {
        tarray::column search -all -eq -among {} [newcolumn string {
            x x x x x
        }] x
    } -result [crep int {}] -match column

    #
    # string -lt
    test column_search-string-lt-2.0 {
        Find first match
    } -body {
        tarray::column search -lt [newcolumn string {first {with spaces} { leading space} UPPERCASE 10 5.0e5}] abc
    } -result 2

    test column_search-string-lt-2.1 {
        Match on last element
    } -body {
        tarray::column search -lt [newcolumn string {first {with spaces} AAA { leading space} AAA 5.0e5}] ABC
    } -result 2

    test column_search-string-lt-2.2 {
        Match -inline
    } -body {
        tarray::column search -lt -inline [newcolumn string {
            first {with spaces} { leading space} AAA 5.0e5
        }] abc
    } -result { leading space}

    test column_search-string-lt-2.3 {
        Match -all (one element)
    } -body {
        tarray::column search -lt -all [newcolumn string {
            first {with spaces} { leading space} " AAA" zzz
        }] " aaa"
    } -result [crep int {3}] -match column

    test column_search-string-lt-2.4 {
        Match -all
    } -body {
        tarray::column search -lt -all [newcolumn string {
            first { leading space} {with spaces} AAA 5.0e5
        }] aaa
    } -result [crep int {1 3 4}] -match column
    
    test column_search-string-lt-2.5 {
        Match -all -inline
    } -body {
        tarray::column search -lt -all -inline [newcolumn string {
            first { leading space} {with spaces} AAA 5.0e5
        }] AAA
    } -result [crep string {{ leading space} 5.0e5}] -match column

    test column_search-string-lt-2.6 {
        Verify comparisons are strings, not numeric
    } -body {
        tarray::column search -lt [newcolumn string {010 1}] 2
    } -result 0

    test column_search-string-lt-3.0 {
        Match -not (equal)
    } -body {
        tarray::column search -not -lt [newcolumn string {ABC second {with spaces} AAA { leading space} AAA 5.0e5}] ABC
    } -result 0

    test column_search-string-lt-3.1 {
        Match on element -not -inline (when greater)
    } -body {
        tarray::column search -not -lt -inline [newcolumn string {{with spaces} ABA { leading space} AAA 5.0e5}] ABC
    } -result {with spaces}

    test column_search-string-lt-3.2 {
        Match on last element -not (when equal)
    } -body {
        tarray::column search -not -lt [newcolumn string {{with spaces} ABA { leading space} AAA 5.0e5 zzz}] zzz
    } -result 5

    test column_search-string-lt-3.3 {
        Match on element -not
    } -body {
        tarray::column search -not -lt [newcolumn string {{with spaces} ABA { leading space} AAA 5.0e5 zzz}] zzz
    } -result 5

    test column_search-string-lt-3.4 {
        Match in middle -not -all
    } -body {
        tarray::column search -not -lt -all [newcolumn string {{with spaces} aaa ABA { leading space} AAA 5.0e5 zzz}] aaa
    } -result [crep int {0 1 6}] -match column

    test column_search-string-lt-3.5 {
        Match in middle -not -inline -all
    } -body {
        tarray::column search -not -lt -inline -all [newcolumn string {{with spaces} aaa ABA { leading space} AAA 5.0e5 zzz}] aaa
    } -result [crep string {{with spaces} aaa zzz}] -match column

    test column_search-string-lt-3.6 {
        Verify comparisons are strings, not numeric (-not -inline)
    } -body {
        tarray::column search -not -lt -inline -all [newcolumn string {010 1 0 10}] 00
    } -result [crep string {010 1 10}] -match column

    test column_search-string-lt-4.0 {
        Match on element -range
    } -body {
        tarray::column search -lt -range 1 [newcolumn string {aaa zzz bbb ccc ddd}] zzz
    } -result 2

    test column_search-string-lt-4.1 {
        Match fail -range
    } -body {
        tarray::column search -lt -range 1 [newcolumn string {aaa zzz bbb ccc ddd}] bbb
    } -result -1

    test column_search-string-lt-4.2 {
        Match -inline -range
    } -body {
        tarray::column search -lt -range 1 -inline [newcolumn string {aaa zzz bbb ccc ddd}] zzz
    } -result bbb

    test column_search-string-lt-4.3 {
        Match -all -range (one element)
    } -body {
        tarray::column search -lt -range 1 -all [newcolumn string {aaa zzz bbb ccc ddd}] ccc
    } -result [crep int {2}] -match column

    test column_search-string-lt-4.4 {
        Match -all -range
    } -body {
        tarray::column search -lt -range 2 -all [newcolumn string {aaa zzz bbb eee ccc ddd}] ddd
    } -result [crep int {2 4}] -match column

    test column_search-string-lt-4.5 {
        Match -all -inline -range
    } -body {
        tarray::column search -lt -range 2 -all -inline [newcolumn string {aaa zzz bbb eee ccc ddd}] ddd
    } -result [crep string {bbb ccc}] -match column

    test column_search-string-lt-4.6 {
        Match -range -not
    } -body {
        tarray::column search -not -lt -range 2 [newcolumn string {aaa zzz bbb eee ccc ddd}] bbb
    } -result 2

    test column_search-string-lt-4.7 {
        Match -inline -range -not -all
    } -body {
        tarray::column search -not -lt -range 2 -all -inline [newcolumn string {aaa zzz bbb eee ccc ddd}] ccc
    } -result [crep string {eee ccc ddd}] -match column

    test column_search-string-lt-4.8 {
        Match -all -inline -range 
    } -body {
        tarray::column search -lt -range 0 -inline -all [newcolumn string {aaa zzz bbb eee ccc ddd}] ccc
    } -result [crep string {aaa bbb}] -match column

    test column_search-string-lt-4.9 {
        Match -all -inline -range out of bounds
    } -body {
        tarray::column search -lt -range 10 -inline -all [newcolumn string {aaa zzz bbb eee ccc}] ccc
    } -result [crep string {}] -match column

    test column_search-string-lt-4.10 {
        Match -range end
    } -body {
        tarray::column search -lt -range end -inline [newcolumn string {aaa zzz bbb eee ccc}] ccc
    } -result {}

    test column_search-string-lt-4.11 {
        Match on element -range
    } -body {
        tarray::column search -lt -range {1 end} [newcolumn string {aaa zzz bbb ccc ddd}] zzz
    } -result 2

    test column_search-string-lt-4.12 {
        Match fail -range
    } -body {
        tarray::column search -lt -range {1 4} [newcolumn string {aaa zzz bbb ccc ddd aaa}] bbb
    } -result -1

    test column_search-string-lt-4.13 {
        Match -inline -range
    } -body {
        tarray::column search -lt -range {1 4} -inline [newcolumn string {aaa zzz bbb ccc ddd}] zzz
    } -result bbb

    test column_search-string-lt-4.14 {
        Match -all -range (one element)
    } -body {
        tarray::column search -lt -range {1 4} -all [newcolumn string {aaa zzz bbb ccc ddd}] ccc
    } -result [crep int {2}] -match column

    test column_search-string-lt-4.15 {
        Match -all -range
    } -body {
        tarray::column search -lt -range {2 5} -all [newcolumn string {aaa zzz bbb eee ccc ddd ccc}] ddd
    } -result [crep int {2 4}] -match column

    test column_search-string-lt-4.16 {
        Match -all -inline -range
    } -body {
        tarray::column search -lt -range {2 5} -all -inline [newcolumn string {aaa zzz bbb eee ccc ddd ccc}] ddd
    } -result [crep string {bbb ccc}] -match column

    test column_search-string-lt-4.17 {
        Match -range -not
    } -body {
        tarray::column search -not -lt -range {2 4} [newcolumn string {aaa zzz bbb eee ccc ddd}] bbb
    } -result 2

    test column_search-string-lt-4.18 {
        Match -inline -range -not -all
    } -body {
        tarray::column search -not -lt -range {2 6} -all -inline [newcolumn string {aaa zzz bbb eee ccc ddd bbb eee}] ccc
    } -result [crep string {eee ccc ddd}] -match column

    test column_search-string-lt-4.19 {
        Match -all -inline -range 
    } -body {
        tarray::column search -lt -range {0 5} -inline -all [newcolumn string {aaa zzz bbb eee ccc ddd aaa}] ccc
    } -result [crep string {aaa bbb}] -match column

    test column_search-string-lt-4.20 {
        Match -all -inline -range out of bounds
    } -body {
        tarray::column search -lt -range {5 10} -inline -all [newcolumn string {aaa zzz bbb eee bbb}] ccc
    } -result [crep string {}] -match column

    test column_search-string-lt-4.21 {
        Match -range end
    } -body {
        tarray::column search -lt -range {end end} -inline [newcolumn string {aaa zzz bbb eee aaa}] ccc
    } -result aaa

    test column_search-string-lt-4.22 {
        Match -range end
    } -body {
        tarray::column search -lt -range {end 0} [newcolumn string {aaa zzz bbb eee aaa}] ccc
    } -result -1

    test column_search-string-lt-4.23 {
        Match on element -among
    } -body {
        tarray::column search -lt -among {1 3 4} [newcolumn string {a d c d e f}] e
    } -result 1

    test column_search-string-lt-4.24 {
        Match on element -among (fail)
    } -body {
        tarray::column search -lt -among {1 3 4} [newcolumn string {a e b e e f}] e
    } -result -1

    test column_search-string-lt-4.25 {
        Match -inline -among
    } -body {
        tarray::column search -lt -inline -among {1 3 4 7} [newcolumn string {
            a z c d e f g b
        }] f
    } -result d

    test column_search-string-lt-4.26 {
        Match -inline -among out of order indices
    } -body {
        tarray::column search -lt -inline -among {1 4 3 7} [newcolumn string {
            a z c d e f g b
        }] f
    } -result e

    test column_search-string-lt-4.27 {
        Match -all -among (negative and out of bounds indices)
    } -body {
        tarray::column search -lt -all -among {-1 3 5 7} [newcolumn string {
            a z c z e f g
        }] g
    } -result [crep int {5}] -match column

    test column_search-string-lt-4.28 {
        Match -not -all -among -inline (negative and out of bounds indices)
    } -body {
        tarray::column search -inline -not -lt -all -among {-1 3 5 6 7} [newcolumn string {
            a z c d e f c
        }] c
    } -result [crep string {d f c}] -match column

    test column_search-string-lt-4.29 {
        Match -among -range -all
    } -body {
        tarray::column search -lt -all -range {1 5} -among {0 5 7 5 4} [newcolumn string {
            z c D e F c d z
        }] g
    } -result [crep int {5 5 4}] -match column

    test column_search-string-lt-4.30 {
        Match -among -range -inline -all
    } -body {
        tarray::column search -lt -inline -all -range {1 5} -among {0 5 7 5 4} [newcolumn string {
            z c D e F c d z
        }] g
    } -result [crep string {c c F}] -match column

    test column_search-string-lt-4.31 {
        Match -among -range
    } -body {
        tarray::column search -lt -range {1 5} -among {0 5 7 5 4} [newcolumn string {
            z c D e F c d z
        }] g
    } -result 5

    test column_search-string-lt-4.32 {
        Match -among -range -inline
    } -body {
        tarray::column search -inline -lt -range {1 5} -among {0 4 5 7 } [newcolumn string {
            a c D e F c d z
        }] g
    } -result F -match numeric

    test column_search-string-lt-4.33 {
        Match -range -inline (empty)
    } -body {
        tarray::column search -lt -among {0 1} [newcolumn string {}] xxx
    } -result -1

    test column_search-string-lt-4.34 {
        Match -range -inline (empty)
    } -body {
        tarray::column search -inline -lt -among {0} [newcolumn string {}] xxx
    } -result {}

    test column_search-string-lt-4.35 {
        Match -among -range reversed
    } -body {
        tarray::column search -lt -range {5 0} -among {0 5 7 5 4} [newcolumn string {
            aaa aaa aaa
        }] aaa
    } -result -1

    test column_search-string-lt-4.36 {
        Match -among empty
    } -body {
        tarray::column search -lt -among {} [newcolumn string {
            aaa aaa aaa
        }] aaa
    } -result -1

    test column_search-string-lt-4.37 {
        Match -among -inline empty
    } -body {
        tarray::column search -inline -lt -among {} [newcolumn string {
            aaa aaa aaa
        }] aaa
    } -result {}

    test column_search-string-lt-4.44 {
        Match -among -all empty
    } -body {
        tarray::column search -all -lt -among {} [newcolumn string {
            aaa aaa aaa
        }] aaa
    } -result [crep int {}] -match column

    test column_search-string-lt-6.0 {
        Match missing element
    } -body {
        tarray::column search -lt [newcolumn string {aaa zzz bbb eee ccc}] aaa
    } -result -1

    test column_search-string-lt-6.1 {
        Match missing element -inline
    } -body {
        tarray::column search -lt -inline [newcolumn string {aaa zzz bbb eee ccc}] aaa
    } -result ""

    test column_search-string-lt-6.2 {
        Match missing element -all
    } -body {
        tarray::column search -lt -all [newcolumn string {aaa zzz bbb eee ccc}] aaa
    } -result [crep int {}] -match column

    test column_search-string-lt-6.3 {
        Match missing element -not
    } -body {
        tarray::column search -lt -not [newcolumn string {aaa bbb eee ccc}] zzz
    } -result -1

    test column_search-string-lt-6.4 {
        Match missing element -not -inline -all
    } -body {
        tarray::column search -lt -not -inline -all [newcolumn string {aaa bbb eee ccc}] zzz
    } -result [crep string {}] -match column

    #
    # -gt

    test column_search-string-gt-2.0 {
        Find first match
    } -body {
        tarray::column search -gt [newcolumn string {first {with spaces} { leading space} UPPERCASE 10 5.0e5}] abc
    } -result 0

    test column_search-string-gt-2.1 {
        Match on last element
    } -body {
        tarray::column search -gt [newcolumn string {first {with spaces} AAA { leading space} AAA 5.0e5 zzz}] yyy
    } -result 6

    test column_search-string-gt-2.2 {
        Match -inline
    } -body {
        tarray::column search -gt -inline [newcolumn string {
            abc {with spaces} { leading space} AAA 5.0e5
        }] abc
    } -result {with spaces}

    test column_search-string-gt-2.3 {
        Match -all (one element)
    } -body {
        tarray::column search -gt -all [newcolumn string {
            first {with spaces} { leading space} " AAA"
        }] w
    } -result [crep int {1}] -match column

    test column_search-string-gt-2.4 {
        Match -all
    } -body {
        tarray::column search -gt -all [newcolumn string {
            first { leading space} {with spaces} AAA 5.0e5
        }] aaa
    } -result [crep int {0 2}] -match column
    
    test column_search-string-gt-2.5 {
        Match -all -inline
    } -body {
        tarray::column search -gt -all -inline [newcolumn string {
            first { leading space} {with spaces} AAA 5.0e5
        }] AAA
    } -result [crep string {first {with spaces}}] -match column

    test column_search-string-gt-2.6 {
        Verify comparisons are strings, not numeric
    } -body {
        tarray::column search -gt [newcolumn string {21 1}] 200
    } -result 0

    test column_search-string-gt-3.0 {
        Match -not (equal)
    } -body {
        tarray::column search -not -gt [newcolumn string {ABC second {with spaces} AAA { leading space} AAA 5.0e5}] ABC
    } -result 0

    test column_search-string-gt-3.1 {
        Match on element -not -inline (when greater)
    } -body {
        tarray::column search -not -gt -inline [newcolumn string {{with spaces} ABA { leading space} AAA 5.0e5}] ABC
    } -result {ABA}

    test column_search-string-gt-3.2 {
        Match on last element -not (when equal)
    } -body {
        tarray::column search -not -gt [newcolumn string {first {with spaces} ABA AAA 5.0e5}] 5.0e5
    } -result 4

    test column_search-string-gt-3.4 {
        Match in middle -not -all
    } -body {
        tarray::column search -not -gt -all [newcolumn string {{with spaces} aaa ABA { leading space} AAA 5.0e5 zzz}] aaa
    } -result [crep int {1 2 3 4 5}] -match column

    test column_search-string-gt-3.5 {
        Match in middle -not -inline -all
    } -body {
        tarray::column search -not -gt -inline -all [newcolumn string {{with spaces} aaa ABA { leading space} AAA 5.0e5 zzz}] aaa
    } -result [crep string {aaa ABA { leading space} AAA 5.0e5}] -match column

    test column_search-string-gt-3.6 {
        Verify comparisons are strings, not numeric (-not -inline)
    } -body {
        tarray::column search -not -gt -inline -all [newcolumn string {010 1 0}] 1
    } -result [crep string {010 1 0}] -match column

    test column_search-string-gt-4.0 {
        Match on element -range
    } -body {
        tarray::column search -gt -range 1 [newcolumn string {aaa bbb ccc ddd}] bbb
    } -result 2

    test column_search-string-gt-4.1 {
        Match fail -range
    } -body {
        tarray::column search -gt -range 1 [newcolumn string {zzz bbb ccc ddd}] ddd
    } -result -1

    test column_search-string-gt-4.2 {
        Match -inline -range
    } -body {
        tarray::column search -gt -range 2 -inline [newcolumn string {aaa zzz bbb ccc ddd}] ccc
    } -result ddd

    test column_search-string-gt-4.3 {
        Match -all -range (one element)
    } -body {
        tarray::column search -gt -range 2 -all [newcolumn string {aaa zzz bbb ccc ddd}] ccc
    } -result [crep int {4}] -match column

    test column_search-string-gt-4.4 {
        Match -all -range
    } -body {
        tarray::column search -gt -range 2 -all [newcolumn string {aaa zzz bbb eee ccc ddd}] ccc
    } -result [crep int {3 5}] -match column

    test column_search-string-gt-4.5 {
        Match -all -inline -range
    } -body {
        tarray::column search -gt -range 2 -all -inline [newcolumn string {aaa zzz bbb eee ccc ddd}] ccc
    } -result [crep string {eee ddd}] -match column

    test column_search-string-gt-4.6 {
        Match -range -not
    } -body {
        tarray::column search -not -gt -range 1 [newcolumn string {aaa zzz bbb eee ccc ddd}] bbb
    } -result 2

    test column_search-string-gt-4.7 {
        Match -inline -range -not -all
    } -body {
        tarray::column search -not -gt -range 2 -all -inline [newcolumn string {aaa zzz bbb eee ccc ddd}] ccc
    } -result [crep string {bbb ccc}] -match column

    test column_search-string-gt-4.8 {
        Match -all -inline -range 0
    } -body {
        tarray::column search -gt -range 0 -inline -all [newcolumn string {aaa zzz bbb eee ccc ddd}] ccc
    } -result [crep string {zzz eee ddd}] -match column

    test column_search-string-gt-4.9 {
        Match -all -inline -range out of bounds
    } -body {
        tarray::column search -gt -range 10 -inline -all [newcolumn string {aaa zzz bbb eee ccc}] ccc
    } -result [crep string {}] -match column

    test column_search-string-gt-4.10 {
        Match -range end
    } -body {
        tarray::column search -gt -range end -inline [newcolumn string {aaa zzz bbb eee ccc}] ccc
    } -result {}

    test column_search-string-gt-4.11 {
        Match on element -range
    } -body {
        tarray::column search -gt -range {1 end} [newcolumn string {aaa bbb ccc ddd}] bbb
    } -result 2

    test column_search-string-gt-4.12 {
        Match fail -range
    } -body {
        tarray::column search -gt -range {1 end} [newcolumn string {zzz bbb ccc ddd}] ddd
    } -result -1

    test column_search-string-gt-4.14 {
        Match -all -range (one element)
    } -body {
        tarray::column search -gt -range {2 6} -all [newcolumn string {aaa zzz bbb ccc ddd bbb aaa fff}] ccc
    } -result [crep int {4}] -match column

    test column_search-string-gt-4.15 {
        Match -all -range
    } -body {
        tarray::column search -gt -range {2 6} -all [newcolumn string {aaa zzz bbb eee ccc ddd aaa qqq}] ccc
    } -result [crep int {3 5}] -match column

    test column_search-string-gt-4.16 {
        Match -all -inline -range
    } -body {
        tarray::column search -gt -range {2 6} -all -inline [newcolumn string {aaa zzz bbb eee ccc ddd aaa fff}] ccc
    } -result [crep string {eee ddd}] -match column

    test column_search-string-gt-4.17 {
        Match -range -not
    } -body {
        tarray::column search -not -gt -range {1 end} [newcolumn string {aaa zzz bbb eee ccc ddd}] bbb
    } -result 2

    test column_search-string-gt-4.18 {
        Match -inline -range -not -all
    } -body {
        tarray::column search -not -gt -range {2 5} -all -inline [newcolumn string {aaa zzz bbb eee ccc ddd aaa}] ccc
    } -result [crep string {bbb ccc}] -match column

    test column_search-string-gt-4.19 {
        Match -all -inline -range out of bounds
    } -body {
        tarray::column search -gt -range {10 20} -inline -all [newcolumn string {aaa zzz bbb eee ccc}] ccc
    } -result [crep string {}] -match column

    test column_search-string-gt-4.20 {
        Match -range end
    } -body {
        tarray::column search -gt -range {end  end} -inline [newcolumn string {aaa zzz bbb eee ccc ddd}] ccc
    } -result {ddd}

    test column_search-string-gt-4.22 {
        Match -range end
    } -body {
        tarray::column search -lt -range {end 0} -inline [newcolumn string {aaa zzz bbb eee aaa}] ccc
    } -result {}

    test column_search-string-gt-4.23 {
        Match -range end
    } -body {
        tarray::column search -lt -range {end 0} -inline -all [newcolumn string {aaa zzz bbb eee aaa}] ccc
    } -result [crep string {}] -match column

    test column_search-string-gt-4.24 {
        Match on element -among
    } -body {
        tarray::column search -gt -among {1 3 4} [newcolumn string {
            e b c d e f
        }] b
    } -result 3

    test column_search-string-gt-4.25 {
        Match on element -among (fail)
    } -body {
        tarray::column search -gt -among {1 3 4} [newcolumn string {
            e a e d c f
        }] d
    } -result -1

    test column_search-string-gt-4.26 {
        Match -inline -among
    } -body {
        tarray::column search -gt -inline -among {1 3 4 7} [newcolumn string {
            e b c d e f
        }] b
    } -result d

    test column_search-string-gt-4.27 {
        Match -inline -among out of order indices
    } -body {
        tarray::column search -gt -inline -among {1 4 3 7} [newcolumn string {
            e b c d e f
        }] b
    } -result e

    test column_search-string-gt-4.28 {
        Match -all -among (negative and out of bounds indices)
    } -body {
        tarray::column search -gt -all -among {-1 3 5 7} [newcolumn string {
            b b b a b b b
        }] a
    } -result [crep int {5}] -match column

    test column_search-string-gt-4.29 {
        Match -not -all -among -inline (negative and out of bounds indices)
    } -body {
        tarray::column search -inline -not -gt -all -among {-1 3 5 6 7} [newcolumn string {
            a b c d c f e
        }] e
    } -result [crep string {d e}] -match column

    test column_search-string-gt-4.30 {
        Match -among -range -all
    } -body {
        tarray::column search -gt -all -range {1 5} -among {0 1 5 7 5 4} [newcolumn string {
            f z g c h i j a a
        }] e
    } -result [crep int {1 5 5 4}] -match column

    test column_search-string-gt-4.31 {
        Match -among -range -all -inline
    } -body {
        tarray::column search -gt -all -inline -range {1 5} -among {0 1 5 7 5 4} [newcolumn string {
            f z g c h i j a a
        }] e
    } -result [crep string {z i i h}] -match column

    test column_search-string-gt-4.32 {
        Match -among -range
    } -body {
        tarray::column search -gt -range {1 5} -among {0 5 4 7} [newcolumn string {
            g A b c F a b c d 
        }] E
    } -result 5

    test column_search-string-gt-4.33 {
        Match -among -range -inline
    } -body {
        tarray::column search -inline -gt -range {1 5} -among {0 4 5 7 } [newcolumn string {
            g A b c d A b c d 
        }] E
    } -result d

    test column_search-string-gt-4.34 {
        Match -range -inline (empty)
    } -body {
        tarray::column search -gt -among {0 1} [newcolumn string {}] aaa
    } -result -1

    test column_search-string-gt-4.35 {
        Match -range -inline (empty)
    } -body {
        tarray::column search -inline -gt -among {0} [newcolumn string {}] aaa
    } -result {}

    test column_search-string-gt-4.36 {
        Match -among -range reversed
    } -body {
        tarray::column search -gt -range {5 0} -among {0 5 7 5 4} [newcolumn string {
            b b b b b b b b b
        }] a
    } -result -1

    test column_search-string-gt-4.37 {
        Match -among empty
    } -body {
        tarray::column search -gt -among {} [newcolumn string {
            b b b b b b b 
        }] a
    } -result -1

    test column_search-string-gt-4.38 {
        Match -among -inline empty
    } -body {
        tarray::column search -inline -gt -among {} [newcolumn string {
            b b b b b 
        }] a
    } -result {}

    test column_search-string-gt-4.39 {
        Match -among -all empty
    } -body {
        tarray::column search -all -gt -among {} [newcolumn string {
            b b b b b 
        }] a
    } -result [crep int {}] -match column

    test column_search-string-gt-6.0 {
        Match missing element
    } -body {
        tarray::column search -gt [newcolumn string {aaa bbb eee ccc}] xxx
    } -result -1

    test column_search-string-gt-6.1 {
        Match missing element -inline
    } -body {
        tarray::column search -gt -inline [newcolumn string {aaa zzz bbb eee ccc}] zzz
    } -result ""

    test column_search-string-gt-6.2 {
        Match missing element -all
    } -body {
        tarray::column search -gt -all [newcolumn string {aaa zzz bbb eee ccc}] zzz
    } -result [crep int {}] -match column

    test column_search-string-gt-6.3 {
        Match missing element -not
    } -body {
        tarray::column search -gt -not [newcolumn string {zzz bbb eee ccc}] aaa
    } -result -1

    test column_search-string-gt-6.4 {
        Match missing element -not -inline -all
    } -body {
        tarray::column search -gt -not -inline -all [newcolumn string {zzz bbb eee ccc}] aaa
    } -result [crep string {}] -match column

    #
    # -pat

    test column_search-string-pat-1.0 {
        Search empty column
    } -body {
        tarray::column search -pat [newcolumn string {}] *
    } -result -1

    test column_search-string-pat-1.1 {
        Search empty column
    } -body {
        tarray::column search -pat -inline [newcolumn string {}] *
    } -result {}

    test column_search-string-pat-2.0 {
        Match on first element
    } -body {
        tarray::column search -pat [newcolumn string {abc def hij}] *
    } -result 0

    test column_search-string-pat-2.1 {
        Match on first element -inline 
    } -body {
        tarray::column search -inline -pat [newcolumn string {abc def hij}] *
    } -result abc

    test column_search-string-pat-2.2 {
        Match on last element 
    } -body {
        tarray::column search -pat [newcolumn string {abc def hij}] h*
    } -result 2

    test column_search-string-pat-2.3 {
        Match on last element 
    } -body {
        tarray::column search -pat -inline [newcolumn string {abc def hij}] *j
    } -result hij

    test column_search-string-pat-2.4 {
        Match -all (one element)
    } -body {
        tarray::column search -pat -all [newcolumn string {
            first {with spaces} { leading space} " AAA" 
        }] *A*
    } -result [crep int {3}] -match column

    test column_search-string-pat-2.5 {
        Match -all
    } -body {
        tarray::column search -pat -all [newcolumn string {
            first { leading space} {with spaces} AAA 5.0e5
        }] "* *"
    } -result [crep int {1 2}] -match column
    
    test column_search-string-pat-2.6 {
        Match -all -inline
    } -body {
        tarray::column search -pat -all -inline [newcolumn string {
            first { leading space} {with spaces} AAA 5.0e5
        }] *s*
    } -result [crep string {first { leading space} {with spaces}}] -match column

    test column_search-string-pat-3.0 {
        Match -not
    } -body {
        tarray::column search -not -pat [newcolumn string {aaa bbb ccc ddd eee}] a*
    } -result 1

    test column_search-string-pat-3.1 {
        Match on element -not -inline
    } -body {
        tarray::column search -not -pat -inline [newcolumn string {abc acb bca bac cab cba}] *c
    } -result acb

    test column_search-string-pat-3.2 {
        Match on element -not -all
    } -body {
        tarray::column search -not -pat -all [newcolumn string {abc acb bca bac cab cba}] *c
    } -result [crep int {1 2 4 5}] -match column

    test column_search-string-pat-3.3 {
        Match on element -not -all -inline
    } -body {
        tarray::column search -not -pat -all -inline [newcolumn string {abc acb bca bac cab cba}] *c
    } -result [crep string {acb bca cab cba}] -match column

    test column_search-string-pat-4.0 {
        Match on element -range
    } -body {
        tarray::column search -pat -range 2 [newcolumn string {abc acb bca bac cab cba}] *c
    } -result 3

    test column_search-string-pat-4.1 {
        Match fail -range
    } -body {
        tarray::column search -pat -range 1 [newcolumn string {zzz bbb ccc ddd}] a*
    } -result -1

    test column_search-string-pat-4.2 {
        Match -inline -range
    } -body {
        tarray::column search -pat -range 2 -inline [newcolumn string {abc acb bca bac cab cba}] *c
    } -result bac

    test column_search-string-pat-4.3 {
        Match -all -range
    } -body {
        tarray::column search -all -pat -range 2 [newcolumn string {abc acb bca bac cab cba dcb}] *c?
    } -result [crep int {2 6}] -match column

    test column_search-string-pat-4.4 {
        Match -all -inline -range
    } -body {
        tarray::column search -all -pat -range 2 -inline [newcolumn string {abc acb bca bac cab cba}] *c?
    } -result [crep string {bca}] -match column

    test column_search-string-pat-4.5 {
        Match -range -not
    } -body {
        tarray::column search -not -pat -range 2 [newcolumn string {abc acb bca bac cab cba}] *c?
    } -result 3

    test column_search-string-pat-4.6 {
        Match -inline -range -not -all
    } -body {
        tarray::column search -not -all -pat -range 2 -inline [newcolumn string {abc acb bca bac cab cba}] *c?
    } -result [crep string {bac cab cba}] -match column

    test column_search-string-pat-4.7 {
        Match -all -inline -range 0
    } -body {
        tarray::column search -all -pat -range 0 -inline [newcolumn string {abc acb bca bac cab cba}] *c?
    } -result [crep string {acb bca}] -match column

    test column_search-string-pat-4.8 {
        Match -all -inline -range out of bounds
    } -body {
        tarray::column search -pat -range 10 -inline -all [newcolumn string {aaa zzz bbb eee ccc}] c*
    } -result [crep string {}] -match column

    test column_search-string-pat-4.9 {
        Match on element -range
    } -body {
        tarray::column search -pat -range {2 end} [newcolumn string {abc acb bca bac cab cba}] *c
    } -result 3

    test column_search-string-pat-4.10 {
        Match fail -range
    } -body {
        tarray::column search -pat -range {1 3} [newcolumn string {zzz bbb ccc ddd aaa}] a*
    } -result -1

    test column_search-string-pat-4.11 {
        Match -inline -range
    } -body {
        tarray::column search -pat -range {2 5} -inline [newcolumn string {abc acb bca bac cab cba}] *c
    } -result bac

    test column_search-string-pat-4.12 {
        Match -all -range
    } -body {
        tarray::column search -all -pat -range {2 6} [newcolumn string {abc acb bca bac cab cba dcb dcb}] *c?
    } -result [crep int {2 6}] -match column

    test column_search-string-pat-4.13 {
        Match -all -inline -range
    } -body {
        tarray::column search -all -pat -range {2 5} -inline [newcolumn string {abc acb bca bac cab cba bca}] *c?
    } -result [crep string {bca}] -match column

    test column_search-string-pat-4.14 {
        Match -range -not
    } -body {
        tarray::column search -not -pat -range {2 5} [newcolumn string {abc acb bca bac cab cba}] *c?
    } -result 3

    test column_search-string-pat-4.15 {
        Match -inline -range -not -all
    } -body {
        tarray::column search -not -all -pat -range {2 5} -inline [newcolumn string {abc acb bca bac cab cba cba}] *c?
    } -result [crep string {bac cab cba}] -match column

    test column_search-string-pat-4.16 {
        Match -all -inline -range out of bounds
    } -body {
        tarray::column search -pat -range {5 10} -inline -all [newcolumn string {aaa zzz bbb eee ccc}] c*
    } -result [crep string {}] -match column

    test column_search-string-pat-4.17 {
        Match -all -range reverse
    } -body {
        tarray::column search -pat -range {end 0} -inline -all [newcolumn string {aaa zzz bbb eee ccc}] c*
    } -result [crep string {}] -match column

    test column_search-string-pat-4.18 {
        Match -all -range reverse
    } -body {
        tarray::column search -pat -range {end 0} -all [newcolumn string {aaa zzz bbb eee ccc}] c*
    } -result [crep int {}] -match column

    test column_search-string-pat-4.19 {
        Match on element -among
    } -body {
        tarray::column search -pat -among {1 3 4} [newcolumn string {
            aaa bbb aaa abc def a
        }] a*
    } -result 3

    test column_search-string-pat-4.20 {
        Match on element -among (fail)
    } -body {
        tarray::column search -pat -among {1 3 4} [newcolumn string {
            aaa bbb aaa bc def a
        }] a*
    } -result -1

    test column_search-string-pat-4.21 {
        Match -inline -among
    } -body {
        tarray::column search -pat -inline -among {1 3 4 7} [newcolumn string {
            a ba ab abc abd
        }] a*
    } -result abc

    test column_search-string-pat-4.22 {
        Match -among out of order indices
    } -body {
        tarray::column search -nocase -pat -among {1 4 3 7} [newcolumn string {
            a b ab abc ABC a a
        }] a*
    } -result 4

    test column_search-string-pat-4.23 {
        Match -all -among (negative and out of bounds indices)
    } -body {
        tarray::column search -pat -all -among {-1 3 5 7} [newcolumn string {
            ab A c A ab ad a da
        }] a*
    } -result [crep int {5}] -match column

    test column_search-string-pat-4.24 {
        Match -not -all -among -inline (negative and out of bounds indices)
    } -body {
        tarray::column search -inline -nocase -not -pat -all -among {-1 3 5 6 7} [newcolumn string {
            a b x X e f g x
        }] x*
    } -result [crep string {f g}] -match column

    test column_search-string-pat-4.25 {
        Match -among -range -all
    } -body {
        tarray::column search -nocase -pat -all -range {1 5} -among {0 5 7 5 4} [newcolumn string {
            a xy xy xy XY xy xy xy
        }] x*
    } -result [crep int {5 5 4}] -match column

    test column_search-string-pat-4.26 {
        Match -among -range -inline -all -not
    } -body {
        tarray::column search -not -pat -inline -all -range {1 5} -among {0 5 7 5 4} [newcolumn string {
            a x x e X f g x
        }] x*
    } -result [crep string {f f X}] -match column

    test column_search-string-pat-4.27 {
        Match -among -range
    } -body {
        tarray::column search -nocase -pat -range {1 5} -among {0 5 7 5 4} [newcolumn string {
            a x x x x X x
        }] x*
    } -result 5

    test column_search-string-pat-4.28 {
        Match -among -range -inline -not
    } -body {
        tarray::column search -inline -not -pat -range {1 5} -among {0 4 5 7 } [newcolumn string {
            a b c d a f g
        }] a*
    } -result f

    test column_search-string-pat-4.29 {
        Match -among (empty)
    } -body {
        tarray::column search -pat -among {0 1} [newcolumn string {}] x*
    } -result -1

    test column_search-string-pat-4.30 {
        Match -among -inline (empty)
    } -body {
        tarray::column search -inline -pat -among {0} [newcolumn string {}] x*
    } -result {}

    test column_search-string-pat-4.31 {
        Match -among -range reversed
    } -body {
        tarray::column search -pat -range {5 0} -among {0 1 2 3 4 5 6} [newcolumn string {
            x x x x
        }] x*
    } -result -1

    test column_search-string-pat-4.32 {
        Match -among empty
    } -body {
        tarray::column search -pat -among {} [newcolumn string {
            x x x x x
        }] x
    } -result -1

    test column_search-string-pat-4.33 {
        Match -among -inline empty
    } -body {
        tarray::column search -inline -pat -among {} [newcolumn string {
            x x x x x
        }] x
    } -result {}

    test column_search-string-pat-4.34 {
        Match -among -all empty
    } -body {
        tarray::column search -all -pat -among {} [newcolumn string {
            x x x x x
        }] x
    } -result [crep int {}] -match column

    test column_search-string-pat-5.0 {
        Match missing element
    } -body {
        tarray::column search -pat [newcolumn string {aaa zzz bbb eee ccc}] s*
    } -result -1

    test column_search-string-pat-5.1 {
        Match missing element -inline
    } -body {
        tarray::column search -pat -inline [newcolumn string {aaa zzz bbb eee ccc}] x*
    } -result ""

    test column_search-string-pat-5.2 {
        Match missing element -all
    } -body {
        tarray::column search -pat -all [newcolumn string {aaa zzz bbb eee ccc}] *x
    } -result [crep int {}] -match column

    test column_search-string-pat-5.3 {
        Match missing element -not
    } -body {
        tarray::column search -pat -not [newcolumn string {abc aaa a12}] a*
    } -result -1

    test column_search-string-pat-5.4 {
        Match missing element -not -inline -all
    } -body {
        tarray::column search -pat -not -inline -all [newcolumn string {abc aaa a12}] a*
    } -result [crep string {}] -match column


    #
    # -re

    test column_search-string-re-1.0 {
        Search empty column
    } -body {
        tarray::column search -re [newcolumn string {}] .*
    } -result -1

    test column_search-string-re-1.1 {
        Search empty column
    } -body {
        tarray::column search -re -inline [newcolumn string {}] .*
    } -result {}

    test column_search-string-re-2.0 {
        Match on first element
    } -body {
        tarray::column search -re [newcolumn string {abc def hij}] {a..$}
    } -result 0

    test column_search-string-re-2.1 {
        Match on first element -inline 
    } -body {
        tarray::column search -inline -re [newcolumn string {abc def hij}] ^a
    } -result abc

    test column_search-string-re-2.2 {
        Match on last element 
    } -body {
        tarray::column search -re [newcolumn string {abc def hij}] h
    } -result 2

    test column_search-string-re-2.3 {
        Match on last element 
    } -body {
        tarray::column search -re -inline [newcolumn string {abc def hij}] j\$
    } -result hij

    test column_search-string-re-2.4 {
        Match -all (one element)
    } -body {
        tarray::column search -re -all [newcolumn string {
            a b c d e
        }] d
    } -result [crep int {3}] -match column

    test column_search-string-re-2.5 {
        Match -all
    } -body {
        tarray::column search -re -all [newcolumn string {
            first { leading space} {with spaces} AAA 5.0e5
        }] "space"
    } -result [crep int {1 2}] -match column
    
    test column_search-string-re-2.6 {
        Match -all -inline
    } -body {
        tarray::column search -re -all -inline [newcolumn string {
            first { leading space} {with spaces} AAA 5.0e5
        }] space
    } -result [crep string {{ leading space} {with spaces}}] -match column

    test column_search-string-re-3.0 {
        Match -not
    } -body {
        tarray::column search -not -re [newcolumn string {aaa bbb ccc ddd eee}] a
    } -result 1

    test column_search-string-re-3.1 {
        Match on element -not -inline
    } -body {
        tarray::column search -not -re -inline [newcolumn string {abc acb bca bac cab cba}] .c
    } -result cab

    test column_search-string-re-3.2 {
        Match on element -not -all
    } -body {
        tarray::column search -not -re -all [newcolumn string {abc acb bca bac cab cba}] c.
    } -result [crep int {0 3}] -match column

    test column_search-string-re-3.3 {
        Match on element -not -all -inline
    } -body {
        tarray::column search -not -re -all -inline [newcolumn string {abc acb bca bac cab cba}]  c..
    } -result [crep string {abc acb bca bac}] -match column

    test column_search-string-re-4.0 {
        Match on element -range
    } -body {
        tarray::column search -re -range 2 [newcolumn string {abc acb bca bac cab cba}] ..c
    } -result 3

    test column_search-string-re-4.1 {
        Match fail -range
    } -body {
        tarray::column search -re -range 1 [newcolumn string {zzz bbb ccc ddd}] a
    } -result -1

    test column_search-string-re-4.2 {
        Match -inline -range
    } -body {
        tarray::column search -re -range 2 -inline [newcolumn string {abc acb bca bac cab cba}] ..c
    } -result bac

    test column_search-string-re-4.3 {
        Match -all -range
    } -body {
        tarray::column search -all -re -range 2 [newcolumn string {abc acb bca bac cab cba dcb}] c.
    } -result [crep int {2 4 5 6}] -match column

    test column_search-string-re-4.4 {
        Match -all -inline -range
    } -body {
        tarray::column search -all -re -range 2 -inline [newcolumn string {abc acb bca bac cab cba}] ac
    } -result [crep string {bac}] -match column

    test column_search-string-re-4.5 {
        Match -range -not
    } -body {
        tarray::column search -not -re -range 2 [newcolumn string {abc acb bca bac cab cba}] b.*c
    } -result 4

    test column_search-string-re-4.6 {
        Match -inline -range -not -all
    } -body {
        tarray::column search -not -all -re -range 2 -inline [newcolumn string {abc acb bca bac cab cba}] b.
    } -result [crep string {cab}] -match column

    test column_search-string-re-4.7 {
        Match -all -inline -range 0
    } -body {
        tarray::column search -all -re -range 0 -inline [newcolumn string {abc acb bca bac cab cba}] c.
    } -result [crep string {acb bca cab cba}] -match column

    test column_search-string-re-4.8 {
        Match -all -inline -range out of bounds
    } -body {
        tarray::column search -re -range 10 -inline -all [newcolumn string {aaa zzz bbb eee ccc}] c
    } -result [crep string {}] -match column

    test column_search-string-re-4.9 {
        Match on element -range
    } -body {
        tarray::column search -re -range {2 end} [newcolumn string {abc acb bca bac cab cba}] ..c
    } -result 3

    test column_search-string-re-4.10 {
        Match fail -range
    } -body {
        tarray::column search -re -range {1 3} [newcolumn string {zzz bbb ccc ddd a}] a
    } -result -1

    test column_search-string-re-4.11 {
        Match -inline -range (fail)
    } -body {
        tarray::column search -re -range {2 5} -inline [newcolumn string {abc bac xxx yyy zzz acb bca bac cab}] ..c
    } -result {}

    test column_search-string-re-4.12 {
        Match -range
    } -body {
        tarray::column search -re -range {2 5} [newcolumn string {abc bac xxx ccc zzz acb bca bac cab}] ..c
    } -result 3

    test column_search-string-re-4.13 {
        Match -all -range
    } -body {
        tarray::column search -all -re -range {2 5} [newcolumn string {abc acb bca bac cab cba dcb}] c.
    } -result [crep int {2 4 5}] -match column

    test column_search-string-re-4.14 {
        Match -all -inline -range
    } -body {
        tarray::column search -all -re -range {2 5} -inline [newcolumn string {abc acb bca bac cab cba ac}] ac
    } -result [crep string {bac}] -match column

    test column_search-string-re-4.15 {
        Match -inline -range -not -all
    } -body {
        tarray::column search -not -all -re -range {2 6} -inline [newcolumn string {abc acb bca bac cab cba acb cab}] b.
    } -result [crep string {cab acb}] -match column

    test column_search-string-re-4.16 {
        Match -all -inline -range out of bounds
    } -body {
        tarray::column search -re -range {5 10} -inline -all [newcolumn string {aaa zzz bbb eee ccc}] c
    } -result [crep string {}] -match column

    test column_search-string-re-4.17 {
        Match -all -inline -range reverse
    } -body {
        tarray::column search -re -range {3 1} -inline -all [newcolumn string {aaa zzz bbb eee ccc}] .
    } -result [crep string {}] -match column

    test column_search-string-re-4.19 {
        Match on element -among
    } -body {
        tarray::column search -re -among {1 3 4} [newcolumn string {
            aaa bbb aaa abc def a
        }] a.*
    } -result 3

    test column_search-string-re-4.20 {
        Match on element -among (fail)
    } -body {
        tarray::column search -re -among {1 3 4} [newcolumn string {
            aaa bbb aaa bc def a
        }] a.*
    } -result -1

    test column_search-string-re-4.21 {
        Match -inline -among
    } -body {
        tarray::column search -re -inline -among {1 3 4 7} [newcolumn string {
            a b ab abc abd
        }] a.*
    } -result abc

    test column_search-string-re-4.22 {
        Match -among out of order indices
    } -body {
        tarray::column search -nocase -re -among {1 4 3 7} [newcolumn string {
            a b ab abc ABC a a
        }] a.*
    } -result 4

    test column_search-string-re-4.23 {
        Match -all -among (negative and out of bounds indices)
    } -body {
        tarray::column search -re -all -among {-1 3 5 7} [newcolumn string {
            ab A c A ab ad a b
        }] a.*
    } -result [crep int {5}] -match column

    test column_search-string-re-4.24 {
        Match -not -all -among -inline (negative and out of bounds indices)
    } -body {
        tarray::column search -inline -nocase -not -re -all -among {-1 3 5 6 7} [newcolumn string {
            a b x X e f g x
        }] x.*
    } -result [crep string {f g}] -match column

    test column_search-string-re-4.25 {
        Match -among -range -all
    } -body {
        tarray::column search -nocase -re -all -range {1 5} -among {0 5 7 5 4} [newcolumn string {
            a xy xy xy XY xy xy xy
        }] x.*
    } -result [crep int {5 5 4}] -match column

    test column_search-string-re-4.26 {
        Match -among -range -inline -all -not
    } -body {
        tarray::column search -not -re -inline -all -range {1 5} -among {0 5 7 5 4} [newcolumn string {
            a x x e X f g x
        }] x.*
    } -result [crep string {f f X}] -match column

    test column_search-string-re-4.27 {
        Match -among -range
    } -body {
        tarray::column search -nocase -re -range {1 5} -among {0 5 7 5 4} [newcolumn string {
            a x x x x X x
        }] x.*
    } -result 5

    test column_search-string-re-4.28 {
        Match -among -range -inline -not
    } -body {
        tarray::column search -inline -not -re -range {1 5} -among {0 4 5 7 } [newcolumn string {
            a b c d a f g
        }] a.*
    } -result f

    test column_search-string-re-4.29 {
        Match -among (empty)
    } -body {
        tarray::column search -re -among {0 1} [newcolumn string {}] x.*
    } -result -1

    test column_search-string-re-4.30 {
        Match -among -inline (empty)
    } -body {
        tarray::column search -inline -re -among {0} [newcolumn string {}] x.*
    } -result {}

    test column_search-string-re-4.31 {
        Match -among -range reversed
    } -body {
        tarray::column search -re -range {5 0} -among {0 1 2 3 4 5 6} [newcolumn string {
            x x x x
        }] x.*
    } -result -1

    test column_search-string-re-4.32 {
        Match -among empty
    } -body {
        tarray::column search -re -among {} [newcolumn string {
            x x x x x
        }] x
    } -result -1

    test column_search-string-re-4.33 {
        Match -among -inline empty
    } -body {
        tarray::column search -inline -re -among {} [newcolumn string {
            x x x x x
        }] x
    } -result {}

    test column_search-string-re-4.34 {
        Match -among -all empty
    } -body {
        tarray::column search -all -re -among {} [newcolumn string {
            x x x x x
        }] x
    } -result [crep int {}] -match column

    test column_search-string-re-5.0 {
        Match missing element
    } -body {
        tarray::column search -re [newcolumn string {aaa zzz bbb eee ccc}] s
    } -result -1

    test column_search-string-re-5.1 {
        Match missing element -inline
    } -body {
        tarray::column search -re -inline [newcolumn string {aaa zzz bbb eee ccc}] x
    } -result ""

    test column_search-string-re-5.2 {
        Match missing element -all
    } -body {
        tarray::column search -re -all [newcolumn string {aaa zzz bbb eee ccc}] x
    } -result [crep int {}] -match column

    test column_search-string-re-5.3 {
        Match missing element -not
    } -body {
        tarray::column search -re -not [newcolumn string {abc aaa a12}] a
    } -result -1

    test column_search-string-re-5.4 {
        Match missing element -not -inline -all
    } -body {
        tarray::column search -re -not -inline -all [newcolumn string {abc aaa a12}] a
    } -result [crep string {}] -match column

    #
    # -nocase

    test column_search-string-eq-nocase-1.0 {
        Verify case sensitivity without -nocase
    } -body {
        tarray::column search -eq [newcolumn string {aaa AAA aaa AAA}] AAA
    } -result 1

    test column_search-string-eq-nocase-1.1 {
        Verify case sensitivity without -nocase
    } -body {
        tarray::column search -eq -range 1 [newcolumn string {aaa AAA aaa AAA}] aaa
    } -result 2

    test column_search-string-eq-nocase-2.0 {
        Verify case insensitivity with -nocase
    } -body {
        tarray::column search -eq -nocase [newcolumn string {aaa AAA aaa AAA}] AAA
    } -result 0

    test column_search-string-eq-nocase-2.1 {
        Verify case insensitivity with -nocase
    } -body {
        tarray::column search -eq -nocase -range 1 [newcolumn string {aaa AAA aaa AAA}] aaa
    } -result 1

    test column_search-string-pat-nocase-1.0 {
        Verify case sensitivity without -nocase
    } -body {
        tarray::column search -pat [newcolumn string {aaa AAA aaa AAA}] A*
    } -result 1

    test column_search-string-pat-nocase-1.1 {
        Verify case sensitivity without -nocase
    } -body {
        tarray::column search -pat -range 1 [newcolumn string {aaa AAA aaa AAA}] a*
    } -result 2

    test column_search-string-pat-nocase-2.0 {
        Verify case insensitivity with -nocase
    } -body {
        tarray::column search -pat -nocase [newcolumn string {aaa AAA aaa AAA}] A*
    } -result 0

    test column_search-string-pat-nocase-2.1 {
        Verify case insensitivity with -nocase
    } -body {
        tarray::column search -pat -nocase -range 1 [newcolumn string {aaa AAA aaa AAA}] a*
    } -result 1

    test column_search-string-re-nocase-1.0 {
        Verify case sensitivity without -nocase
    } -body {
        tarray::column search -re [newcolumn string {aaa AAA aaa AAA}] A
    } -result 1

    test column_search-string-re-nocase-1.1 {
        Verify case sensitivity without -nocase
    } -body {
        tarray::column search -re -range 1 [newcolumn string {aaa AAA aaa AAA}] a
    } -result 2

    test column_search-string-re-nocase-2.0 {
        Verify case insensitivity with -nocase
    } -body {
        tarray::column search -re -nocase [newcolumn string {aaa AAA aaa AAA}] A
    } -result 0

    test column_search-string-re-nocase-2.1 {
        Verify case insensitivity with -nocase
    } -body {
        tarray::column search -re -nocase -range 1 [newcolumn string {aaa AAA aaa AAA}] a
    } -result 1

    test column_search-string-lt-nocase-1.0 {
        Verify case sensitivity without -nocase
    } -body {
        tarray::column search -lt [newcolumn string {aBd aba}] abc
    } -result 0

    test column_search-string-lt-nocase-1.1 {
        Verify case sensitivity without -nocase
    } -body {
        tarray::column search -lt [newcolumn string {aBd aba}] Abc
    } -result -1

    test column_search-string-lt-nocase-2.0 {
        Verify case insensitivity with -nocase
    } -body {
        tarray::column search -lt -nocase [newcolumn string {aBd aba}] abc
    } -result 1

    test column_search-string-lt-nocase-2.1 {
        Verify case insensitivity with -nocase
    } -body {
        tarray::column search -lt -nocase [newcolumn string {abd aba}] Abc
    } -result 1

    test column_search-string-gt-nocase-1.0 {
        Verify case sensitivity without -nocase
    } -body {
        tarray::column search -gt [newcolumn string {aBd abe}] abc
    } -result 1

    test column_search-string-gt-nocase-1.1 {
        Verify case sensitivity without -nocase
    } -body {
        tarray::column search -gt [newcolumn string {aBb aba}] Abc
    } -result 0

    test column_search-string-gt-nocase-2.0 {
        Verify case insensitivity with -nocase
    } -body {
        tarray::column search -gt -nocase [newcolumn string {aBd abe}] abc
    } -result 0

    test column_search-string-gt-nocase-2.1 {
        Verify case insensitivity with -nocase
    } -body {
        tarray::column search -gt -nocase [newcolumn string {aba abd}] Abc
    } -result 1

    # Notes on testing large columns
    # When the list is large, multithread searches are used where the
    # column is split in two halves. Our tests must cover the cases
    # where hits are found in the different halves
    # The tests assume multithreaded searches split the items roughly equally
    #
    # boolean type is not tested as it has no MT implementation
    foreach type {any string byte double int uint wide} {
        test column_search-large-$type-eq-1.0 {
            Verify elements in first half are found before elements in second and elements in both halves are returned
        } -body {
            set l [lsearch -inline -all -not [largelist $type] 0]
            set n [llength $l]
            if {$n < [tarray::unsupported::config search_mt_threshold]} {
                error "Not enough elements for MT search"
            }
            set pos1 [expr {$n/2 - 10}]; # Toward end of first half
            set pos2 [expr {$n/2 + 10}]; # Toward beginning of second half so second thread should find it quicker
            lset l $pos1 0
            lset l $pos2 0
            list \
                [expr {[tarray::column search [tarray::column create $type $l] 0] == $pos1}] \
                [string equal [tarray::column search -all [tarray::column create $type $l] 0] [list tarray_column int [list $pos1 $pos2]]] \
                [tarray::column search -inline [tarray::column create $type $l] 0] \
                [tarray::column search -all -inline [tarray::column create $type $l] 0]
        } -result [list 1 1 [expr {$type eq "double" ? "0.0" : 0}] [list tarray_column $type [expr {$type eq "double" ? "0.0 0.0" : "0 0"}] ]]
        
        test column_search-large-$type-eq-1.1 {
            Verify elements in second half are returned even if no elems in first
        } -body {
            set l [lsearch -inline -all -not [largelist $type] 0]
            set n [llength $l]
            if {$n < [tarray::unsupported::config search_mt_threshold]} {
                error "Not enough elements for MT search"
            }
            set pos [expr {$n/2 + 10}]; # Toward beginning of second half so second thread should find it quicker
            lset l $pos 0
            lset l end 0
            list \
                [expr {[tarray::column search [tarray::column create $type $l] 0] == $pos}] \
                [string equal [tarray::column search -all [tarray::column create $type $l] 0] [list tarray_column int [list $pos [incr n -1]]]] \
                [tarray::column search -inline [tarray::column create $type $l] 0] \
                [tarray::column search -all -inline [tarray::column create $type $l] 0]
        } -result [list 1 1 [expr {$type eq "double" ? "0.0" : 0}] [list tarray_column $type [expr {$type eq "double" ? "0.0 0.0" : "0 0"}] ]]

        test column_search-large-$type-eq-1.2 {
            Verify when search fails on large list
        } -body {
            set l [lsearch -inline -all -not [largelist $type] 0]
            set n [llength $l]
            if {$n < [tarray::unsupported::config search_mt_threshold]} {
                error "Not enough elements for MT search"
            }
            list \
                [tarray::column search [tarray::column create $type $l] 0] \
                [tarray::column search -all [tarray::column create $type $l] 0] \
                [tarray::column search -inline [tarray::column create $type $l] 0] \
                [tarray::column search -all -inline [tarray::column create $type $l] 0] \

        } -result [list -1 [list tarray_column int {}] {} [list tarray_column $type {}]]

        test column_search-large-$type-eq-2.0 {
            Verify large list -eq -not
        } -body {
            # Make sure we control number of times 0 occurs
            set l [lsearch -inline -all -not [largelist $type] 0]
            set n [llength $l]
            if {$n < [tarray::unsupported::config search_mt_threshold]} {
                error "Not enough elements for MT search"
            }
            set pos1 [expr {$n/2 - 10}]; # Toward end of first half
            set pos2 [expr {$n/2 + 10}]; # Toward beginning of second half so second thread should find it quicker
            lset l $pos1 0
            lset l $pos2 0
            lset l 0 0
            lset l end 0
            cequal [tarray::column search -eq -not -all [tarray::column create $type $l] 0] [list tarray_column int [lsearch -all -not $l 0]]
        } -result 1

        test column_search-large-$type-eq-2.1 {
            Verify large list -eq -not -inline
        } -body {
            # Make sure we control number of times 0 occurs
            set l [lsearch -inline -all -not [largelist $type] 0]
            set n [llength $l]
            if {$n < [tarray::unsupported::config search_mt_threshold]} {
                error "Not enough elements for MT search"
            }
            set pos1 [expr {$n/2 - 10}]; # Toward end of first half
            set pos2 [expr {$n/2 + 10}]; # Toward beginning of second half so second thread should find it quicker
            lset l $pos1 0
            lset l $pos2 0
            lset l 0 0
            lset l end 0
            cequal [tarray::column search -inline -eq -not -all [tarray::column create $type $l] 0] [list tarray_column $type [lsearch -inline -all -not $l 0]]
        } -result 1

        ### -le

        test column_search-large-$type-ltgt-1.0 {
            Matching elements in both halves
        } -body {
            lassign [dict get {
                any  {a j z}
                string {a j z}
                int  {-1 0 1}
                uint {0 100 1000}
                wide {-1 0 1}
                double {-1.0 0.0 1.0}
                byte {0 128 255}
            } $type] low elem high

            set n [tarray::unsupported::config search_mt_threshold]
            set l [lrepeat $n $elem]
            set lowpos1 [expr {$n/2 - 10}]; # Toward end of first half
            set highpos1 [expr {$lowpos1-1}]
            set lowpos2 [expr {$n/2 + 10}]; # Toward beginning of second half so second thread should find it quicker
            set highpos2 [expr {$lowpos2+1}]
            lset l $lowpos1 $low
            lset l $highpos1 $high
            lset l $lowpos2 $low
            lset l $highpos2 $high

            set col [tarray::column create $type $l]

            list \
                [tcl::mathop::== [tarray::column search -gt $col $elem] $highpos1] \
                [tcl::mathop::== [tarray::column search -lt $col $elem] $lowpos1] \
                [cequal [tarray::column search -gt -all $col $elem] [list tarray_column int [list $highpos1 $highpos2]]] \
                [cequal [tarray::column search -inline -gt -all $col $elem] [list tarray_column $type [list $high $high]]] \
                [cequal [tarray::column search -lt -all $col $elem] [list tarray_column int [list $lowpos1 $lowpos2]]] \
                [cequal [tarray::column search -inline -lt -all $col $elem] [list tarray_column $type [list $low $low]]] \
                [cequal [tarray::column search -not -gt -all $col $low] [list tarray_column int [list $lowpos1 $lowpos2]]] \
                [cequal [tarray::column search -not -inline -lt -all $col $high] [list tarray_column $type [list $high $high]]]
        } -result {1 1 1 1 1 1 1 1}
        

    }

    # TBD - Verify MT is effective by setting thresholds
    # TBD - large boolean tests
    
}





::tcltest::cleanupTests
